import{d as ce,A as fe,r as x,c as Q,x as M,a as u,o as i,b as s,u as t,g as ve,e as l,f as a,j as b,m as v,t as d,h as r,F as h,l as $,n as _e,B as ye,i as X,k as ge,v as be}from"./app-BRfPHPqy.js";import{_ as xe}from"./AppLayout.vue_vue_type_script_setup_true_lang-qG5md34Y.js";import{c as te,_ as c}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DDgYw2Ah.js";import{_ as T}from"./Card.vue_vue_type_script_setup_true_lang-U1IKHtfC.js";import{_ as V}from"./CardContent.vue_vue_type_script_setup_true_lang-aWC4hv9I.js";import{_ as D}from"./CardDescription.vue_vue_type_script_setup_true_lang-CL8IiMy2.js";import{_ as R,a as F}from"./CardTitle.vue_vue_type_script_setup_true_lang-TFgOJAjh.js";import{_ as E}from"./Input.vue_vue_type_script_setup_true_lang-BM4Ek6WA.js";import{_ as I}from"./Label.vue_vue_type_script_setup_true_lang-a6NoeD4F.js";import{_ as j,a as L,b as N,c as z}from"./DialogTitle.vue_vue_type_script_setup_true_lang-DoAe4RpO.js";import{_ as B,a as O}from"./DialogHeader.vue_vue_type_script_setup_true_lang-B9Q_iTed.js";import{C as q}from"./circle-check-big-DDtWlqMl.js";import{U as he}from"./user-plus-B-1knQ0W.js";import{U as P}from"./user-lWjC_tUq.js";import{T as Z}from"./trash-2-Czo74-tZ.js";import{M as G}from"./mail-Dpg6EsyG.js";import{D as U}from"./dollar-sign-BB6ZMg7M.js";import"./AppSidebarLayout.vue_vue_type_script_setup_true_lang-CaVARo9u.js";import"./useForwardExpose-DvZO0AV6.js";import"./RovingFocusGroup-DpSOVpWp.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=te("CopyIcon",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=te("CrownIcon",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]),we={class:"p-6 space-y-6"},Ce={key:0,class:"bg-green-50 border border-green-200 rounded-lg p-4"},Se={class:"flex items-start gap-3"},$e={class:"flex-1"},Ie={class:"text-green-800 font-medium"},Ue={class:"text-green-700 text-sm mt-1"},Me={class:"mt-3 flex items-center gap-2"},Te={class:"flex items-center justify-between"},Ve={class:"text-gray-600 mt-1"},Re={class:"space-y-4"},Ee={class:"flex-1"},Pe={class:"flex items-center gap-3"},Ae={class:"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center"},De={class:"font-medium"},Fe={class:"text-sm text-gray-600"},je={class:"text-xs text-gray-500"},Le={class:"flex items-center gap-3"},Ne={class:"relative"},ze=["value","onChange","disabled"],Be=["value"],Oe={key:1,class:"w-9 h-9"},qe={key:0,class:"text-center py-8 text-gray-500"},Ge={class:"space-y-4"},Je={class:"flex-1"},Ke={class:"flex items-center gap-3"},He={class:"font-medium"},We={class:"text-sm text-gray-600"},Ye={class:"text-xs text-gray-500"},Qe={class:"flex items-center gap-2"},Xe={class:"mt-6"},Ze={key:0,class:"text-sm text-red-600 mt-1"},et={class:"relative mt-2"},tt=["value"],st={key:0,class:"text-sm text-red-600 mt-1"},lt={class:"space-y-4"},ot={class:"space-y-2"},at={class:"relative"},nt={class:"space-y-2"},rt={class:"relative"},it={class:"space-y-2"},dt={class:"relative"},Tt=ce({__name:"TeamManagement",props:{team:{},members:{},pendingInvitations:{},availableRoles:{},canInviteUsers:{type:Boolean}},setup(se){const le=se,A=fe();console.log("PAGE PROPS:",A.props),console.log("COMPONENT PROPS:",le);const k=x(!1),w=x(!1),C=x(null),_=x(new Set),S=x(!1),y=x({public_key:"",secret_key:"",webhook_secret:""}),J=Q(()=>{var n,e;return((e=(n=A.props.auth)==null?void 0:n.user)==null?void 0:e.email)||""}),p=M({email:"",role:""}),K=M({role:""}),oe=Q(()=>{var e,g;return(((g=(e=A.props.auth)==null?void 0:e.user)==null?void 0:g.roles)||[]).some(f=>f.name==="Admin")}),ae=n=>{switch(n){case"Admin":return ke;case"Finance":return U;case"Employee":return P;default:return P}},ne=n=>{switch(n){case"Admin":return"text-red-600 bg-red-100";case"Finance":return"text-green-600 bg-green-100";case"Employee":return"text-blue-600 bg-blue-100";default:return"text-gray-600 bg-gray-100"}},re=()=>{p.post(route("team.invitations.send"),{onSuccess:()=>{p.reset(),k.value=!1}})},ie=(n,e)=>{K.role=e,K.patch(route("team.users.role",n.id),{preserveScroll:!0})},de=n=>{M({}).delete(route("team.invitations.cancel",n),{preserveScroll:!0})},ue=n=>{C.value=n,w.value=!0},me=()=>{C.value&&M({}).delete(route("team.users.remove",C.value.id),{onSuccess:()=>{w.value=!1,C.value=null}})},H=n=>new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),W=async(n,e)=>{try{await navigator.clipboard.writeText(n),_.value.add(e),setTimeout(()=>{_.value.delete(e)},2e3)}catch(g){console.error("Failed to copy: ",g);const f=document.createElement("textarea");f.value=n,document.body.appendChild(f),f.select(),document.execCommand("copy"),document.body.removeChild(f),_.value.add(e),setTimeout(()=>{_.value.delete(e)},2e3)}},pe=()=>{alert(`Stripe settings saved!
`+JSON.stringify(y.value,null,2)),S.value=!1};return(n,e)=>(i(),u(h,null,[s(t(ve),{title:"Team Management"}),s(xe,null,{default:l(()=>{var g,f;return[a("div",we,[(g=n.$page.props.flash)!=null&&g.success&&((f=n.$page.props.flash)!=null&&f.invitationUrl)?(i(),u("div",Ce,[a("div",Se,[s(t(q),{class:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}),a("div",$e,[a("h3",Ie,d(n.$page.props.flash.success),1),a("p",Ue,[e[14]||(e[14]=r(" Invitation sent to ")),a("strong",null,d(n.$page.props.flash.invitationEmail),1)]),a("div",Me,[s(t(c),{variant:"outline",size:"sm",onClick:e[0]||(e[0]=o=>W(n.$page.props.flash.invitationUrl,"flash-invitation")),class:"text-blue-600 hover:text-blue-700 hover:bg-blue-50"},{default:l(()=>[_.value.has("flash-invitation")?(i(),v(t(q),{key:0,class:"w-4 h-4 text-green-600"})):(i(),v(t(ee),{key:1,class:"w-4 h-4"})),r(" "+d(_.value.has("flash-invitation")?"Copied!":"Copy Invitation Link"),1)]),_:1})])])])])):b("",!0),a("div",Te,[a("div",null,[e[15]||(e[15]=a("h1",{class:"text-3xl font-bold"},"Team Management",-1)),a("p",Ve," Manage your team members and their roles for "+d(n.team.name),1)]),n.canInviteUsers?(i(),v(t(c),{key:0,onClick:e[1]||(e[1]=o=>k.value=!0),class:"flex items-center gap-2"},{default:l(()=>[s(t(he),{class:"w-4 h-4"}),e[16]||(e[16]=r(" Invite Member "))]),_:1,__:[16]})):b("",!0)]),s(t(T),null,{default:l(()=>[s(t(R),null,{default:l(()=>[s(t(F),{class:"flex items-center gap-2"},{default:l(()=>[s(t(P),{class:"w-5 h-5"}),r(" Team Members ("+d(n.members.length)+") ",1)]),_:1}),s(t(D),null,{default:l(()=>e[17]||(e[17]=[r(" Current members of your team and their assigned roles ")])),_:1,__:[17]})]),_:1}),s(t(V),null,{default:l(()=>[a("div",Re,[(i(!0),u(h,null,$(n.members,o=>(i(),u("div",{key:o.id,class:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50"},[a("div",Ee,[a("div",Pe,[a("div",Ae,[s(t(P),{class:"w-5 h-5 text-gray-600"})]),a("div",null,[a("h3",De,d(o.name),1),a("p",Fe,d(o.email),1),a("p",je," Joined "+d(H(o.created_at)),1)])])]),a("div",Le,[(i(!0),u(h,null,$(o.roles,m=>(i(),u("div",{key:m,class:_e(["flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium",ne(m)])},[(i(),v(ye(ae(m)),{class:"w-3 h-3"})),r(" "+d(m),1)],2))),128)),a("div",Ne,[a("select",{value:o.roles[0]||"",onChange:m=>ie(o,m.target.value),disabled:o.email===J.value,class:"flex h-9 w-32 rounded-md border border-input bg-background px-3 py-1 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},[e[18]||(e[18]=a("option",{value:"",disabled:""},"Select role",-1)),(i(!0),u(h,null,$(n.availableRoles,(m,Y)=>(i(),u("option",{key:Y,value:Y},d(m),9,Be))),128))],40,ze)]),o.email!==J.value?(i(),v(t(c),{key:0,variant:"outline",size:"sm",onClick:m=>ue(o),class:"text-red-600 hover:text-red-700 hover:bg-red-50"},{default:l(()=>[s(t(Z),{class:"w-4 h-4"})]),_:2},1032,["onClick"])):(i(),u("div",Oe))])]))),128)),n.members.length===0?(i(),u("div",qe," No team members found. ")):b("",!0)])]),_:1})]),_:1}),n.pendingInvitations.length>0?(i(),v(t(T),{key:1},{default:l(()=>[s(t(R),null,{default:l(()=>[s(t(F),{class:"flex items-center gap-2"},{default:l(()=>[s(t(G),{class:"w-5 h-5"}),r(" Pending Invitations ("+d(n.pendingInvitations.length)+") ",1)]),_:1}),s(t(D),null,{default:l(()=>e[19]||(e[19]=[r(" Invitations that have been sent but not yet accepted ")])),_:1,__:[19]})]),_:1}),s(t(V),null,{default:l(()=>[a("div",Ge,[(i(!0),u(h,null,$(n.pendingInvitations,o=>(i(),u("div",{key:o.id,class:"flex items-center justify-between p-4 border rounded-lg bg-yellow-50 border-yellow-200"},[a("div",Je,[a("div",Ke,[s(t(G),{class:"w-5 h-5 text-yellow-600"}),a("div",null,[a("h3",He,d(o.email),1),a("p",We," Invited by "+d(o.invited_by)+" â€¢ Role: "+d(o.role),1),a("p",Ye," Expires "+d(H(o.expires_at)),1)])])]),a("div",Qe,[s(t(c),{variant:"outline",size:"sm",onClick:m=>W(o.invitation_url,`invitation-${o.id}`),class:"text-blue-600 hover:text-blue-700 hover:bg-blue-50"},{default:l(()=>[_.value.has(`invitation-${o.id}`)?(i(),v(t(q),{key:0,class:"w-4 h-4 text-green-600"})):(i(),v(t(ee),{key:1,class:"w-4 h-4"})),r(" "+d(_.value.has(`invitation-${o.id}`)?"Copied!":"Copy Link"),1)]),_:2},1032,["onClick"]),s(t(c),{variant:"outline",size:"sm",onClick:m=>de(o.id),class:"text-red-600 hover:text-red-700 hover:bg-red-50"},{default:l(()=>[s(t(Z),{class:"w-4 h-4"}),e[20]||(e[20]=r(" Cancel "))]),_:2,__:[20]},1032,["onClick"])])]))),128))])]),_:1})]),_:1})):b("",!0),s(t(j),{open:k.value,"onUpdate:open":e[5]||(e[5]=o=>k.value=o)},{default:l(()=>[s(t(L),{class:"sm:max-w-md"},{default:l(()=>[s(t(B),{class:"space-y-3"},{default:l(()=>[s(t(N),null,{default:l(()=>e[21]||(e[21]=[r("Invite Team Member")])),_:1,__:[21]}),s(t(z),null,{default:l(()=>[r(" Send an invitation to join "+d(n.team.name)+". They will receive an email with instructions to create their account. ",1)]),_:1})]),_:1}),a("div",Xe,[a("form",{onSubmit:X(re,["prevent"]),class:"space-y-6"},[a("div",null,[s(t(I),{for:"email"},{default:l(()=>e[22]||(e[22]=[r("Email Address")])),_:1,__:[22]}),s(t(E),{id:"email",modelValue:t(p).email,"onUpdate:modelValue":e[2]||(e[2]=o=>t(p).email=o),type:"email",placeholder:"Enter email address",required:"",disabled:t(p).processing,class:"mt-2"},null,8,["modelValue","disabled"]),t(p).errors.email?(i(),u("div",Ze,d(t(p).errors.email),1)):b("",!0)]),a("div",null,[s(t(I),{for:"role"},{default:l(()=>e[23]||(e[23]=[r("Role")])),_:1,__:[23]}),a("div",et,[ge(a("select",{"onUpdate:modelValue":e[3]||(e[3]=o=>t(p).role=o),required:"",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},[e[24]||(e[24]=a("option",{value:"",disabled:""},"Select a role",-1)),(i(!0),u(h,null,$(n.availableRoles,(o,m)=>(i(),u("option",{key:m,value:m},d(o),9,tt))),128))],512),[[be,t(p).role]])]),t(p).errors.role?(i(),u("div",st,d(t(p).errors.role),1)):b("",!0)]),s(t(O),{class:"pt-4"},{default:l(()=>[s(t(c),{type:"button",variant:"outline",onClick:e[4]||(e[4]=o=>k.value=!1)},{default:l(()=>e[25]||(e[25]=[r(" Cancel ")])),_:1,__:[25]}),s(t(c),{type:"submit",disabled:t(p).processing},{default:l(()=>[r(d(t(p).processing?"Sending...":"Send Invitation"),1)]),_:1},8,["disabled"])]),_:1})],32)])]),_:1})]),_:1},8,["open"]),s(t(j),{open:w.value,"onUpdate:open":e[7]||(e[7]=o=>w.value=o)},{default:l(()=>[s(t(L),{class:"sm:max-w-md"},{default:l(()=>[s(t(B),null,{default:l(()=>[s(t(N),null,{default:l(()=>e[26]||(e[26]=[r("Remove Team Member")])),_:1,__:[26]}),s(t(z),null,{default:l(()=>{var o;return[r(" Are you sure you want to remove "+d((o=C.value)==null?void 0:o.name)+" from the team? This action cannot be undone. ",1)]}),_:1})]),_:1}),s(t(O),null,{default:l(()=>[s(t(c),{type:"button",variant:"outline",onClick:e[6]||(e[6]=o=>w.value=!1)},{default:l(()=>e[27]||(e[27]=[r(" Cancel ")])),_:1,__:[27]}),s(t(c),{type:"button",variant:"destructive",onClick:me},{default:l(()=>e[28]||(e[28]=[r(" Remove Member ")])),_:1,__:[28]})]),_:1})]),_:1})]),_:1},8,["open"]),oe.value?(i(),v(t(T),{key:2},{default:l(()=>[s(t(R),null,{default:l(()=>[s(t(F),{class:"flex items-center gap-2"},{default:l(()=>[s(t(U),{class:"w-5 h-5 text-purple-600"}),e[29]||(e[29]=r(" Stripe Payment Gateway Setup "))]),_:1,__:[29]}),s(t(D),null,{default:l(()=>e[30]||(e[30]=[r(" Connect and configure your Stripe account to enable online payments for your team. ")])),_:1,__:[30]})]),_:1}),s(t(V),null,{default:l(()=>[a("div",lt,[e[32]||(e[32]=a("p",{class:"text-gray-700"},"To accept payments online, you need to connect your Stripe account. Only admins can see and manage this section.",-1)),s(t(c),{variant:"outline",class:"text-purple-700 border-purple-300 hover:bg-purple-50",onClick:e[8]||(e[8]=o=>S.value=!0)},{default:l(()=>e[31]||(e[31]=[r(" Connect Stripe Account ")])),_:1,__:[31]})])]),_:1})]),_:1})):b("",!0),s(t(j),{open:S.value,"onUpdate:open":e[13]||(e[13]=o=>S.value=o)},{default:l(()=>[s(t(L),{class:"max-w-md w-full p-0"},{default:l(()=>[s(t(T),{class:"shadow-none border-0"},{default:l(()=>[s(t(R),{class:"pb-0"},{default:l(()=>[s(t(B),null,{default:l(()=>[s(t(N),{class:"flex items-center gap-2"},{default:l(()=>[s(t(U),{class:"w-5 h-5 text-purple-600"}),e[33]||(e[33]=r(" Stripe Payment Gateway Setup "))]),_:1,__:[33]}),s(t(z),null,{default:l(()=>e[34]||(e[34]=[r(" Enter your Stripe API keys to enable online payments. You can find these in your Stripe dashboard. ")])),_:1,__:[34]})]),_:1})]),_:1}),s(t(V),{class:"pt-0"},{default:l(()=>[a("form",{onSubmit:X(pe,["prevent"]),class:"space-y-5 mt-2"},[a("div",ot,[s(t(I),{for:"stripe-public-key"},{default:l(()=>e[35]||(e[35]=[r("Stripe Public Key")])),_:1,__:[35]}),a("div",at,[s(t(E),{id:"stripe-public-key",modelValue:y.value.public_key,"onUpdate:modelValue":e[9]||(e[9]=o=>y.value.public_key=o),type:"text",required:"",placeholder:"pk_live_...",class:"pr-10"},null,8,["modelValue"]),s(t(U),{class:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none"})])]),a("div",nt,[s(t(I),{for:"stripe-secret-key"},{default:l(()=>e[36]||(e[36]=[r("Stripe Secret Key")])),_:1,__:[36]}),a("div",rt,[s(t(E),{id:"stripe-secret-key",modelValue:y.value.secret_key,"onUpdate:modelValue":e[10]||(e[10]=o=>y.value.secret_key=o),type:"text",required:"",placeholder:"sk_live_...",class:"pr-10"},null,8,["modelValue"]),s(t(U),{class:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none"})])]),a("div",it,[s(t(I),{for:"stripe-webhook-secret"},{default:l(()=>e[37]||(e[37]=[r("Webhook Secret")])),_:1,__:[37]}),a("div",dt,[s(t(E),{id:"stripe-webhook-secret",modelValue:y.value.webhook_secret,"onUpdate:modelValue":e[11]||(e[11]=o=>y.value.webhook_secret=o),type:"text",required:"",placeholder:"whsec_...",class:"pr-10"},null,8,["modelValue"]),s(t(G),{class:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none"})])]),s(t(O),{class:"flex justify-end gap-2 pt-4"},{default:l(()=>[s(t(c),{type:"button",variant:"outline",onClick:e[12]||(e[12]=o=>S.value=!1)},{default:l(()=>e[38]||(e[38]=[r("Cancel")])),_:1,__:[38]}),s(t(c),{type:"submit"},{default:l(()=>e[39]||(e[39]=[r("Save")])),_:1,__:[39]})]),_:1})],32)]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]}),_:1})],64))}});export{Tt as default};

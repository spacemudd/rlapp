import{y as fe,D as ve,C as _e,r as h,p as X,x as R,c as u,o as d,d as s,u as e,B as ye,w as l,a as o,g as x,b as _,t as i,e as r,F as k,l as U,n as ge,m as be,f as Z,h as xe,i as he}from"./app-DGPdy8tE.js";import{_ as ke}from"./AppLayout.vue_vue_type_script_setup_true_lang-DjXAUWl4.js";import{c as se,_ as c}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CNQnzH42.js";import{_ as T}from"./Card.vue_vue_type_script_setup_true_lang-Co6J2EDk.js";import{_ as M}from"./CardContent.vue_vue_type_script_setup_true_lang-Du459S1j.js";import{_ as F}from"./CardDescription.vue_vue_type_script_setup_true_lang-KpDHoYXP.js";import{_ as E,a as N}from"./CardTitle.vue_vue_type_script_setup_true_lang-B5rRz984.js";import{_ as P}from"./Input.vue_vue_type_script_setup_true_lang-D-rdJcos.js";import{_ as I}from"./Label.vue_vue_type_script_setup_true_lang-CVb8RRH_.js";import{_ as j,a as z,b as B,c as L}from"./DialogTitle.vue_vue_type_script_setup_true_lang-n__8TIm7.js";import{_ as O,a as q}from"./DialogHeader.vue_vue_type_script_setup_true_lang-CRpOQyG4.js";import{C as G}from"./circle-check-big-DNjE99S3.js";import{U as we}from"./user-plus-FPi_mM6b.js";import{U as D}from"./user-CubPX3qw.js";import{T as ee}from"./trash-2-BG7sNOXV.js";import{M as J}from"./mail-DA5wuRdH.js";import{D as V}from"./dollar-sign-D8aiooa7.js";import"./AppSidebarLayout.vue_vue_type_script_setup_true_lang-CiHZFCnI.js";import"./useForwardExpose-C0eXaZLz.js";import"./RovingFocusGroup-ChOkdtX6.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=se("CopyIcon",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=se("CrownIcon",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]),Se={class:"p-6 space-y-6"},$e={key:0,class:"bg-green-50 border border-green-200 rounded-lg p-4"},Ue={class:"flex items-start gap-3"},Ie={class:"flex-1"},Ve={class:"text-green-800 font-medium"},Re={class:"text-green-700 text-sm mt-1"},Te={class:"mt-3 flex items-center gap-2"},Me={class:"flex items-center justify-between"},Ee={class:"text-3xl font-bold"},Pe={class:"text-gray-600 mt-1"},De={class:"space-y-4"},Ae={class:"flex-1"},Fe={class:"flex items-center gap-3"},Ne={class:"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center"},je={class:"font-medium"},ze={class:"text-sm text-gray-600"},Be={class:"text-xs text-gray-500"},Le={class:"flex items-center gap-3"},Oe={class:"relative"},qe=["value","onChange","disabled"],Ge=["value"],Je={key:1,class:"w-9 h-9"},Ke={key:0,class:"text-center py-8 text-gray-500"},He={class:"space-y-4"},We={class:"flex-1"},Ye={class:"flex items-center gap-3"},Qe={class:"font-medium"},Xe={class:"text-sm text-gray-600"},Ze={class:"text-xs text-gray-500"},et={class:"flex items-center gap-2"},tt={class:"mt-6"},st={key:0,class:"text-sm text-red-600 mt-1"},lt={class:"relative mt-2"},at=["value"],ot={key:0,class:"text-sm text-red-600 mt-1"},nt={class:"space-y-4"},rt={class:"space-y-2"},it={class:"relative"},dt={class:"space-y-2"},ut={class:"relative"},mt={class:"space-y-2"},pt={class:"relative"},Et=fe({__name:"TeamManagement",props:{team:{},members:{},pendingInvitations:{},availableRoles:{},canInviteUsers:{type:Boolean}},setup(le){const ae=le,A=ve();console.log("PAGE PROPS:",A.props),console.log("COMPONENT PROPS:",ae);const{t:f}=_e(),w=h(!1),C=h(!1),S=h(null),y=h(new Set),$=h(!1),g=h({public_key:"",secret_key:"",webhook_secret:""}),K=X(()=>{var n,t;return((t=(n=A.props.auth)==null?void 0:n.user)==null?void 0:t.email)||""}),p=R({email:"",role:""}),H=R({role:""}),oe=X(()=>{var t,b;return(((b=(t=A.props.auth)==null?void 0:t.user)==null?void 0:b.roles)||[]).some(v=>v.name==="Admin")}),ne=n=>{switch(n){case"Admin":return Ce;case"Finance":return V;case"Employee":return D;default:return D}},re=n=>{switch(n){case"Admin":return"text-red-600 bg-red-100";case"Finance":return"text-green-600 bg-green-100";case"Employee":return"text-blue-600 bg-blue-100";default:return"text-gray-600 bg-gray-100"}},ie=()=>{p.post(route("team.invitations.send"),{onSuccess:()=>{p.reset(),w.value=!1}})},de=(n,t)=>{H.role=t,H.patch(route("team.users.role",n.id),{preserveScroll:!0})},ue=n=>{R({}).delete(route("team.invitations.cancel",n),{preserveScroll:!0})},me=n=>{S.value=n,C.value=!0},pe=()=>{S.value&&R({}).delete(route("team.users.remove",S.value.id),{onSuccess:()=>{C.value=!1,S.value=null}})},W=n=>new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),Y=async(n,t)=>{try{await navigator.clipboard.writeText(n),y.value.add(t),setTimeout(()=>{y.value.delete(t)},2e3)}catch(b){console.error("Failed to copy: ",b);const v=document.createElement("textarea");v.value=n,document.body.appendChild(v),v.select(),document.execCommand("copy"),document.body.removeChild(v),y.value.add(t),setTimeout(()=>{y.value.delete(t)},2e3)}},ce=()=>{alert(`Stripe settings saved!
`+JSON.stringify(g.value,null,2)),$.value=!1};return(n,t)=>(d(),u(k,null,[s(e(ye),{title:e(f)("team_management")},null,8,["title"]),s(ke,null,{default:l(()=>{var b,v;return[o("div",Se,[(b=n.$page.props.flash)!=null&&b.success&&((v=n.$page.props.flash)!=null&&v.invitationUrl)?(d(),u("div",$e,[o("div",Ue,[s(e(G),{class:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}),o("div",Ie,[o("h3",Ve,i(n.$page.props.flash.success),1),o("p",Re,[r(i(e(f)("send_invitation"))+" ",1),o("strong",null,i(n.$page.props.flash.invitationEmail),1)]),o("div",Te,[s(e(c),{variant:"outline",size:"sm",onClick:t[0]||(t[0]=a=>Y(n.$page.props.flash.invitationUrl,"flash-invitation")),class:"text-blue-600 hover:text-blue-700 hover:bg-blue-50"},{default:l(()=>[y.value.has("flash-invitation")?(d(),_(e(G),{key:0,class:"w-4 h-4 text-green-600"})):(d(),_(e(te),{key:1,class:"w-4 h-4"})),r(" "+i(y.value.has("flash-invitation")?e(f)("success"):e(f)("send_invitation")),1)]),_:1})])])])])):x("",!0),o("div",Me,[o("div",null,[o("h1",Ee,i(e(f)("team_management")),1),o("p",Pe,i(e(f)("manage_team"))+" "+i(n.team.name),1)]),n.canInviteUsers?(d(),_(e(c),{key:0,onClick:t[1]||(t[1]=a=>w.value=!0),class:"flex items-center gap-2"},{default:l(()=>[s(e(we),{class:"w-4 h-4"}),r(" "+i(e(f)("invite_member")),1)]),_:1})):x("",!0)]),s(e(T),null,{default:l(()=>[s(e(E),null,{default:l(()=>[s(e(N),{class:"flex items-center gap-2"},{default:l(()=>[s(e(D),{class:"w-5 h-5"}),r(" "+i(e(f)("team_members"))+" ("+i(n.members.length)+") ",1)]),_:1}),s(e(F),null,{default:l(()=>[r(i(e(f)("manage_team")),1)]),_:1})]),_:1}),s(e(M),null,{default:l(()=>[o("div",De,[(d(!0),u(k,null,U(n.members,a=>(d(),u("div",{key:a.id,class:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50"},[o("div",Ae,[o("div",Fe,[o("div",Ne,[s(e(D),{class:"w-5 h-5 text-gray-600"})]),o("div",null,[o("h3",je,i(a.name),1),o("p",ze,i(a.email),1),o("p",Be," Joined "+i(W(a.created_at)),1)])])]),o("div",Le,[(d(!0),u(k,null,U(a.roles,m=>(d(),u("div",{key:m,class:ge(["flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium",re(m)])},[(d(),_(be(ne(m)),{class:"w-3 h-3"})),r(" "+i(m),1)],2))),128)),o("div",Oe,[o("select",{value:a.roles[0]||"",onChange:m=>de(a,m.target.value),disabled:a.email===K.value,class:"flex h-9 w-32 rounded-md border border-input bg-background px-3 py-1 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},[t[14]||(t[14]=o("option",{value:"",disabled:""},"Select role",-1)),(d(!0),u(k,null,U(n.availableRoles,(m,Q)=>(d(),u("option",{key:Q,value:Q},i(m),9,Ge))),128))],40,qe)]),a.email!==K.value?(d(),_(e(c),{key:0,variant:"outline",size:"sm",onClick:m=>me(a),class:"text-red-600 hover:text-red-700 hover:bg-red-50"},{default:l(()=>[s(e(ee),{class:"w-4 h-4"})]),_:2},1032,["onClick"])):(d(),u("div",Je))])]))),128)),n.members.length===0?(d(),u("div",Ke," No team members found. ")):x("",!0)])]),_:1})]),_:1}),n.pendingInvitations.length>0?(d(),_(e(T),{key:1},{default:l(()=>[s(e(E),null,{default:l(()=>[s(e(N),{class:"flex items-center gap-2"},{default:l(()=>[s(e(J),{class:"w-5 h-5"}),r(" Pending Invitations ("+i(n.pendingInvitations.length)+") ",1)]),_:1}),s(e(F),null,{default:l(()=>t[15]||(t[15]=[r(" Invitations that have been sent but not yet accepted ")])),_:1,__:[15]})]),_:1}),s(e(M),null,{default:l(()=>[o("div",He,[(d(!0),u(k,null,U(n.pendingInvitations,a=>(d(),u("div",{key:a.id,class:"flex items-center justify-between p-4 border rounded-lg bg-yellow-50 border-yellow-200"},[o("div",We,[o("div",Ye,[s(e(J),{class:"w-5 h-5 text-yellow-600"}),o("div",null,[o("h3",Qe,i(a.email),1),o("p",Xe," Invited by "+i(a.invited_by)+" â€¢ Role: "+i(a.role),1),o("p",Ze," Expires "+i(W(a.expires_at)),1)])])]),o("div",et,[s(e(c),{variant:"outline",size:"sm",onClick:m=>Y(a.invitation_url,`invitation-${a.id}`),class:"text-blue-600 hover:text-blue-700 hover:bg-blue-50"},{default:l(()=>[y.value.has(`invitation-${a.id}`)?(d(),_(e(G),{key:0,class:"w-4 h-4 text-green-600"})):(d(),_(e(te),{key:1,class:"w-4 h-4"})),r(" "+i(y.value.has(`invitation-${a.id}`)?e(f)("copied"):e(f)("copy_link")),1)]),_:2},1032,["onClick"]),s(e(c),{variant:"outline",size:"sm",onClick:m=>ue(a.id),class:"text-red-600 hover:text-red-700 hover:bg-red-50"},{default:l(()=>[s(e(ee),{class:"w-4 h-4"}),t[16]||(t[16]=r(" Cancel "))]),_:2,__:[16]},1032,["onClick"])])]))),128))])]),_:1})]),_:1})):x("",!0),s(e(j),{open:w.value,"onUpdate:open":t[5]||(t[5]=a=>w.value=a)},{default:l(()=>[s(e(z),{class:"sm:max-w-md"},{default:l(()=>[s(e(O),{class:"space-y-3"},{default:l(()=>[s(e(B),null,{default:l(()=>t[17]||(t[17]=[r("Invite Team Member")])),_:1,__:[17]}),s(e(L),null,{default:l(()=>[r(" Send an invitation to join "+i(n.team.name)+". They will receive an email with instructions to create their account. ",1)]),_:1})]),_:1}),o("div",tt,[o("form",{onSubmit:Z(ie,["prevent"]),class:"space-y-6"},[o("div",null,[s(e(I),{for:"email"},{default:l(()=>t[18]||(t[18]=[r("Email Address")])),_:1,__:[18]}),s(e(P),{id:"email",modelValue:e(p).email,"onUpdate:modelValue":t[2]||(t[2]=a=>e(p).email=a),type:"email",placeholder:"Enter email address",required:"",disabled:e(p).processing,class:"mt-2"},null,8,["modelValue","disabled"]),e(p).errors.email?(d(),u("div",st,i(e(p).errors.email),1)):x("",!0)]),o("div",null,[s(e(I),{for:"role"},{default:l(()=>t[19]||(t[19]=[r("Role")])),_:1,__:[19]}),o("div",lt,[xe(o("select",{"onUpdate:modelValue":t[3]||(t[3]=a=>e(p).role=a),required:"",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},[t[20]||(t[20]=o("option",{value:"",disabled:""},"Select a role",-1)),(d(!0),u(k,null,U(n.availableRoles,(a,m)=>(d(),u("option",{key:m,value:m},i(a),9,at))),128))],512),[[he,e(p).role]])]),e(p).errors.role?(d(),u("div",ot,i(e(p).errors.role),1)):x("",!0)]),s(e(q),{class:"pt-4"},{default:l(()=>[s(e(c),{type:"button",variant:"outline",onClick:t[4]||(t[4]=a=>w.value=!1)},{default:l(()=>t[21]||(t[21]=[r(" Cancel ")])),_:1,__:[21]}),s(e(c),{type:"submit",disabled:e(p).processing},{default:l(()=>[r(i(e(p).processing?"Sending...":"Send Invitation"),1)]),_:1},8,["disabled"])]),_:1})],32)])]),_:1})]),_:1},8,["open"]),s(e(j),{open:C.value,"onUpdate:open":t[7]||(t[7]=a=>C.value=a)},{default:l(()=>[s(e(z),{class:"sm:max-w-md"},{default:l(()=>[s(e(O),null,{default:l(()=>[s(e(B),null,{default:l(()=>t[22]||(t[22]=[r("Remove Team Member")])),_:1,__:[22]}),s(e(L),null,{default:l(()=>{var a;return[r(" Are you sure you want to remove "+i((a=S.value)==null?void 0:a.name)+" from the team? This action cannot be undone. ",1)]}),_:1})]),_:1}),s(e(q),null,{default:l(()=>[s(e(c),{type:"button",variant:"outline",onClick:t[6]||(t[6]=a=>C.value=!1)},{default:l(()=>t[23]||(t[23]=[r(" Cancel ")])),_:1,__:[23]}),s(e(c),{type:"button",variant:"destructive",onClick:pe},{default:l(()=>t[24]||(t[24]=[r(" Remove Member ")])),_:1,__:[24]})]),_:1})]),_:1})]),_:1},8,["open"]),oe.value?(d(),_(e(T),{key:2},{default:l(()=>[s(e(E),null,{default:l(()=>[s(e(N),{class:"flex items-center gap-2"},{default:l(()=>[s(e(V),{class:"w-5 h-5 text-purple-600"}),t[25]||(t[25]=r(" Stripe Payment Gateway Setup "))]),_:1,__:[25]}),s(e(F),null,{default:l(()=>t[26]||(t[26]=[r(" Connect and configure your Stripe account to enable online payments for your team. ")])),_:1,__:[26]})]),_:1}),s(e(M),null,{default:l(()=>[o("div",nt,[t[28]||(t[28]=o("p",{class:"text-gray-700"},"To accept payments online, you need to connect your Stripe account. Only admins can see and manage this section.",-1)),s(e(c),{variant:"outline",class:"text-purple-700 border-purple-300 hover:bg-purple-50",onClick:t[8]||(t[8]=a=>$.value=!0)},{default:l(()=>t[27]||(t[27]=[r(" Connect Stripe Account ")])),_:1,__:[27]})])]),_:1})]),_:1})):x("",!0),s(e(j),{open:$.value,"onUpdate:open":t[13]||(t[13]=a=>$.value=a)},{default:l(()=>[s(e(z),{class:"max-w-md w-full p-0"},{default:l(()=>[s(e(T),{class:"shadow-none border-0"},{default:l(()=>[s(e(E),{class:"pb-0"},{default:l(()=>[s(e(O),null,{default:l(()=>[s(e(B),{class:"flex items-center gap-2"},{default:l(()=>[s(e(V),{class:"w-5 h-5 text-purple-600"}),t[29]||(t[29]=r(" Stripe Payment Gateway Setup "))]),_:1,__:[29]}),s(e(L),null,{default:l(()=>t[30]||(t[30]=[r(" Enter your Stripe API keys to enable online payments. You can find these in your Stripe dashboard. ")])),_:1,__:[30]})]),_:1})]),_:1}),s(e(M),{class:"pt-0"},{default:l(()=>[o("form",{onSubmit:Z(ce,["prevent"]),class:"space-y-5 mt-2"},[o("div",rt,[s(e(I),{for:"stripe-public-key"},{default:l(()=>t[31]||(t[31]=[r("Stripe Public Key")])),_:1,__:[31]}),o("div",it,[s(e(P),{id:"stripe-public-key",modelValue:g.value.public_key,"onUpdate:modelValue":t[9]||(t[9]=a=>g.value.public_key=a),type:"text",required:"",placeholder:"pk_live_...",class:"pr-10"},null,8,["modelValue"]),s(e(V),{class:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none"})])]),o("div",dt,[s(e(I),{for:"stripe-secret-key"},{default:l(()=>t[32]||(t[32]=[r("Stripe Secret Key")])),_:1,__:[32]}),o("div",ut,[s(e(P),{id:"stripe-secret-key",modelValue:g.value.secret_key,"onUpdate:modelValue":t[10]||(t[10]=a=>g.value.secret_key=a),type:"text",required:"",placeholder:"sk_live_...",class:"pr-10"},null,8,["modelValue"]),s(e(V),{class:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none"})])]),o("div",mt,[s(e(I),{for:"stripe-webhook-secret"},{default:l(()=>t[33]||(t[33]=[r("Webhook Secret")])),_:1,__:[33]}),o("div",pt,[s(e(P),{id:"stripe-webhook-secret",modelValue:g.value.webhook_secret,"onUpdate:modelValue":t[11]||(t[11]=a=>g.value.webhook_secret=a),type:"text",required:"",placeholder:"whsec_...",class:"pr-10"},null,8,["modelValue"]),s(e(J),{class:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none"})])]),s(e(q),{class:"flex justify-end gap-2 pt-4"},{default:l(()=>[s(e(c),{type:"button",variant:"outline",onClick:t[12]||(t[12]=a=>$.value=!1)},{default:l(()=>t[34]||(t[34]=[r("Cancel")])),_:1,__:[34]}),s(e(c),{type:"submit"},{default:l(()=>t[35]||(t[35]=[r("Save")])),_:1,__:[35]})]),_:1})],32)]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]}),_:1})],64))}});export{Et as default};

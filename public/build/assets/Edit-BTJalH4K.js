import{d as R,x as j,r as w,c as A,a as m,o as _,b as s,u as e,g as q,e as o,f as l,S as N,h as n,t as u,i as K,j as c,F as L}from"./app-D0GmyGZl.js";import{_ as Y}from"./AppLayout.vue_vue_type_script_setup_true_lang-ClWf8rUl.js";import{_ as C,a as D,b as V,c as k}from"./CardTitle.vue_vue_type_script_setup_true_lang-B8yC9NBI.js";import{_ as $}from"./CardDescription.vue_vue_type_script_setup_true_lang-CP8_SSbJ.js";import{_ as p}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-qW6pmEna.js";import{_ as x}from"./Input.vue_vue_type_script_setup_true_lang-BYNpB8qG.js";import{_ as f}from"./Label.vue_vue_type_script_setup_true_lang-2Uh-HsNW.js";import{_ as F}from"./Textarea.vue_vue_type_script_setup_true_lang-Co2iLILB.js";import{_ as I}from"./AsyncCombobox.vue_vue_type_script_setup_true_lang-DXw-Yvcw.js";import{A as G}from"./arrow-left-4hzjCcDC.js";import{U as H}from"./user-CXqBrAHC.js";import{C as J,F as Q}from"./AppSidebarLayout.vue_vue_type_script_setup_true_lang-D9xg78FF.js";import{C as W}from"./calendar-CrqvJDC4.js";import{D as Z}from"./dollar-sign-C4HAoaGR.js";import"./useForwardExpose-DFvrxNgW.js";import"./check-DyHuEZLi.js";import"./RovingFocusGroup-DXG8K-w5.js";const X={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},tt={class:"space-y-6"},et={class:"flex items-center gap-4"},st={class:"text-gray-600 mt-1"},at={class:"grid gap-6 lg:grid-cols-2"},ot={class:"space-y-2 relative"},lt={key:0,class:"p-3 bg-blue-50 border border-blue-200 rounded-md mb-3"},rt={class:"flex items-center justify-between"},it={class:"text-sm text-blue-700"},nt={class:"text-xs text-blue-600"},dt={key:1,class:"text-sm text-red-600"},ut={class:"space-y-2 relative"},mt={key:0,class:"text-sm text-red-600"},_t={key:0,class:"p-3 bg-gray-50 rounded-md"},ct={class:"grid grid-cols-3 gap-2 text-sm"},pt={class:"font-medium"},ft={class:"font-medium"},yt={class:"font-medium"},vt={class:"grid gap-4 md:grid-cols-2"},xt={class:"space-y-2"},gt={key:0,class:"text-sm text-red-600"},bt={class:"space-y-2"},Ct={key:0,class:"text-sm text-red-600"},Dt={class:"space-y-3"},Vt={class:"flex flex-wrap gap-2"},kt={key:0,class:"p-3 bg-blue-50 rounded-md"},$t={class:"text-sm text-blue-800"},wt={class:"grid gap-4 md:grid-cols-2"},St={class:"space-y-2"},Ut={key:0,class:"text-sm text-red-600"},Et={class:"space-y-2"},At={key:0,class:"text-sm text-red-600"},Nt={key:0,class:"p-4 bg-green-50 border border-green-200 rounded-md"},Ft={class:"flex justify-between items-center"},It={class:"text-2xl font-bold text-green-900"},Tt={class:"text-sm text-green-700 mt-1"},ht={class:"grid gap-4 md:grid-cols-2"},zt={class:"space-y-2"},Mt={key:0,class:"text-sm text-red-600"},Ot={class:"space-y-2"},Bt={key:0,class:"text-sm text-red-600"},Pt={class:"space-y-2"},Rt={key:0,class:"text-sm text-red-600"},jt={class:"space-y-2"},qt={key:0,class:"text-sm text-red-600"},Kt={class:"flex justify-end gap-3"},ne=R({__name:"Edit",props:{contract:{}},setup(T){const d=T,U=r=>r?new Date(r).toISOString().slice(0,16):"",a=j({customer_id:d.contract.customer_id,vehicle_id:d.contract.vehicle_id,start_date:U(d.contract.start_date),end_date:U(d.contract.end_date),daily_rate:d.contract.daily_rate,deposit_amount:d.contract.deposit_amount,mileage_limit:d.contract.mileage_limit,excess_mileage_rate:d.contract.excess_mileage_rate,terms_and_conditions:d.contract.terms_and_conditions||"",notes:d.contract.notes||""}),h=w(),z=w(),S=w(d.contract.customer?{id:d.contract.customer.id,label:`${d.contract.customer.first_name} ${d.contract.customer.last_name} - ${d.contract.customer.phone}`}:null),y=w(d.contract.vehicle?{id:d.contract.vehicle.id,label:`${d.contract.vehicle.year} ${d.contract.vehicle.make} ${d.contract.vehicle.model} - ${d.contract.vehicle.plate_number}`,data:d.contract.vehicle}:null),g=A(()=>{if(!a.start_date||!a.end_date)return 0;const r=new Date(a.start_date),t=new Date(a.end_date),i=Math.abs(t.getTime()-r.getTime());return Math.ceil(i/(1e3*60*60*24))+1}),E=A(()=>a.daily_rate*g.value),M=r=>{r?(a.customer_id=r.id,S.value=r):(a.customer_id="",S.value=null)},O=r=>{var t;r?(a.vehicle_id=r.id,y.value=r,r.id!==d.contract.vehicle_id&&((t=r.data)!=null&&t.price_daily)&&(a.daily_rate=r.data.price_daily)):(a.vehicle_id="",y.value=null)},b=(r,t="AED")=>{["USD","EUR","AED","GBP","JPY","CAD","AUD","CHF","CNY","SEK","NZD"].includes(t.toUpperCase())||(t="AED");try{return new Intl.NumberFormat("en-AE",{style:"currency",currency:t,minimumFractionDigits:2}).format(r)}catch{return`${t} ${r.toFixed(2)}`}},v=r=>{a.start_date||(a.start_date=new Date().toISOString().slice(0,16));const t=new Date(a.start_date),i=new Date(t);i.setDate(t.getDate()+r-1),a.end_date=i.toISOString().slice(0,16)},B=()=>{a.put(route("contracts.update",d.contract.id))};return(r,t)=>(_(),m(L,null,[s(e(q),{title:`Edit Contract ${r.contract.contract_number}`},null,8,["title"]),s(Y,null,{default:o(()=>[l("div",X,[l("div",tt,[l("div",et,[s(e(N),{href:r.route("contracts.show",r.contract.id)},{default:o(()=>[s(e(p),{variant:"ghost",size:"sm"},{default:o(()=>[s(e(G),{class:"w-4 h-4 mr-2"}),t[15]||(t[15]=n(" Back to Contract "))]),_:1,__:[15]})]),_:1},8,["href"]),l("div",null,[t[16]||(t[16]=l("h1",{class:"text-2xl font-semibold text-gray-900"},"Edit Contract",-1)),l("p",st,u(r.contract.contract_number),1)])]),l("form",{onSubmit:K(B,["prevent"]),class:"space-y-6"},[l("div",at,[s(e(C),null,{default:o(()=>[s(e(D),null,{default:o(()=>[s(e(V),{class:"flex items-center gap-2"},{default:o(()=>[s(e(H),{class:"w-5 h-5"}),t[17]||(t[17]=n(" Customer Information "))]),_:1,__:[17]}),s(e($),null,{default:o(()=>t[18]||(t[18]=[n("Select or change the customer for this contract")])),_:1,__:[18]})]),_:1}),s(e(k),{class:"space-y-4"},{default:o(()=>[l("div",ot,[s(e(f),{for:"customer"},{default:o(()=>t[19]||(t[19]=[n("Customer *")])),_:1,__:[19]}),r.contract.customer?(_(),m("div",lt,[l("div",rt,[l("div",null,[t[20]||(t[20]=l("h4",{class:"font-medium text-blue-900"},"Current Customer",-1)),l("p",it,u(r.contract.customer.first_name)+" "+u(r.contract.customer.last_name)+" - "+u(r.contract.customer.phone),1),l("p",nt,u(r.contract.customer.email),1)])])])):c("",!0),s(I,{ref_key:"customerCombobox",ref:h,selected:S.value,onSelect:M,"search-url":"/api/customers/search",placeholder:"Search to change customer...","empty-message":"No customers found"},null,8,["selected"]),e(a).errors.customer_id?(_(),m("div",dt,u(e(a).errors.customer_id),1)):c("",!0)])]),_:1})]),_:1}),s(e(C),null,{default:o(()=>[s(e(D),null,{default:o(()=>[s(e(V),{class:"flex items-center gap-2"},{default:o(()=>[s(e(J),{class:"w-5 h-5"}),t[21]||(t[21]=n(" Vehicle Information "))]),_:1,__:[21]}),s(e($),null,{default:o(()=>t[22]||(t[22]=[n("Select or change the vehicle for this rental")])),_:1,__:[22]})]),_:1}),s(e(k),{class:"space-y-4"},{default:o(()=>{var i;return[l("div",ut,[s(e(f),{for:"vehicle"},{default:o(()=>t[23]||(t[23]=[n("Vehicle *")])),_:1,__:[23]}),s(I,{ref_key:"vehicleCombobox",ref:z,selected:y.value,onSelect:O,"search-url":"/api/vehicles/search",placeholder:"Search vehicles...","empty-message":"No vehicles found"},null,8,["selected"]),e(a).errors.vehicle_id?(_(),m("div",mt,u(e(a).errors.vehicle_id),1)):c("",!0)]),(i=y.value)!=null&&i.data?(_(),m("div",_t,[t[27]||(t[27]=l("h4",{class:"font-medium text-gray-900 mb-2"},"Pricing Options",-1)),l("div",ct,[l("div",null,[t[24]||(t[24]=l("span",{class:"text-gray-500"},"Daily:",-1)),l("p",pt,u(b(y.value.data.price_daily)),1)]),l("div",null,[t[25]||(t[25]=l("span",{class:"text-gray-500"},"Weekly:",-1)),l("p",ft,u(b(y.value.data.price_weekly)),1)]),l("div",null,[t[26]||(t[26]=l("span",{class:"text-gray-500"},"Monthly:",-1)),l("p",yt,u(b(y.value.data.price_monthly)),1)])])])):c("",!0)]}),_:1})]),_:1})]),s(e(C),null,{default:o(()=>[s(e(D),null,{default:o(()=>[s(e(V),{class:"flex items-center gap-2"},{default:o(()=>[s(e(W),{class:"w-5 h-5"}),t[28]||(t[28]=n(" Contract Details "))]),_:1,__:[28]}),s(e($),null,{default:o(()=>t[29]||(t[29]=[n("Update the rental period and terms")])),_:1,__:[29]})]),_:1}),s(e(k),{class:"space-y-6"},{default:o(()=>[l("div",vt,[l("div",xt,[s(e(f),{for:"start_date"},{default:o(()=>t[30]||(t[30]=[n("Start Date & Time *")])),_:1,__:[30]}),s(e(x),{id:"start_date",type:"datetime-local",modelValue:e(a).start_date,"onUpdate:modelValue":t[0]||(t[0]=i=>e(a).start_date=i),min:new Date().toISOString().slice(0,16),required:""},null,8,["modelValue","min"]),e(a).errors.start_date?(_(),m("div",gt,u(e(a).errors.start_date),1)):c("",!0)]),l("div",bt,[s(e(f),{for:"end_date"},{default:o(()=>t[31]||(t[31]=[n("End Date & Time *")])),_:1,__:[31]}),s(e(x),{id:"end_date",type:"datetime-local",modelValue:e(a).end_date,"onUpdate:modelValue":t[1]||(t[1]=i=>e(a).end_date=i),min:e(a).start_date||new Date().toISOString().slice(0,16),required:""},null,8,["modelValue","min"]),e(a).errors.end_date?(_(),m("div",Ct,u(e(a).errors.end_date),1)):c("",!0)])]),l("div",Dt,[t[39]||(t[39]=l("p",{class:"text-sm font-medium text-gray-700"},"Quick duration:",-1)),l("div",Vt,[s(e(p),{type:"button",variant:"outline",size:"sm",onClick:t[2]||(t[2]=i=>v(1)),class:"text-xs px-3 py-1"},{default:o(()=>t[32]||(t[32]=[n(" 1 day ")])),_:1,__:[32]}),s(e(p),{type:"button",variant:"outline",size:"sm",onClick:t[3]||(t[3]=i=>v(2)),class:"text-xs px-3 py-1"},{default:o(()=>t[33]||(t[33]=[n(" 2 days ")])),_:1,__:[33]}),s(e(p),{type:"button",variant:"outline",size:"sm",onClick:t[4]||(t[4]=i=>v(3)),class:"text-xs px-3 py-1"},{default:o(()=>t[34]||(t[34]=[n(" 3 days ")])),_:1,__:[34]}),s(e(p),{type:"button",variant:"outline",size:"sm",onClick:t[5]||(t[5]=i=>v(4)),class:"text-xs px-3 py-1"},{default:o(()=>t[35]||(t[35]=[n(" 4 days ")])),_:1,__:[35]}),s(e(p),{type:"button",variant:"outline",size:"sm",onClick:t[6]||(t[6]=i=>v(5)),class:"text-xs px-3 py-1"},{default:o(()=>t[36]||(t[36]=[n(" 5 days ")])),_:1,__:[36]}),s(e(p),{type:"button",variant:"outline",size:"sm",onClick:t[7]||(t[7]=i=>v(6)),class:"text-xs px-3 py-1"},{default:o(()=>t[37]||(t[37]=[n(" 6 days ")])),_:1,__:[37]}),s(e(p),{type:"button",variant:"outline",size:"sm",onClick:t[8]||(t[8]=i=>v(7)),class:"text-xs px-3 py-1"},{default:o(()=>t[38]||(t[38]=[n(" 1 week ")])),_:1,__:[38]})])]),g.value>0?(_(),m("div",kt,[l("p",$t,[t[40]||(t[40]=l("strong",null,"Rental Period:",-1)),n(" "+u(g.value)+" day"+u(g.value!==1?"s":""),1)])])):c("",!0)]),_:1})]),_:1}),s(e(C),null,{default:o(()=>[s(e(D),null,{default:o(()=>[s(e(V),{class:"flex items-center gap-2"},{default:o(()=>[s(e(Z),{class:"w-5 h-5"}),t[41]||(t[41]=n(" Pricing & Financial Details "))]),_:1,__:[41]}),s(e($),null,{default:o(()=>t[42]||(t[42]=[n("Update rates and deposit requirements")])),_:1,__:[42]})]),_:1}),s(e(k),{class:"space-y-6"},{default:o(()=>[l("div",wt,[l("div",St,[s(e(f),{for:"daily_rate"},{default:o(()=>t[43]||(t[43]=[n("Daily Rate (AED) *")])),_:1,__:[43]}),s(e(x),{id:"daily_rate",type:"number",step:"0.01",min:"0",modelValue:e(a).daily_rate,"onUpdate:modelValue":t[9]||(t[9]=i=>e(a).daily_rate=i),required:""},null,8,["modelValue"]),e(a).errors.daily_rate?(_(),m("div",Ut,u(e(a).errors.daily_rate),1)):c("",!0)]),l("div",Et,[s(e(f),{for:"deposit_amount"},{default:o(()=>t[44]||(t[44]=[n("Security Deposit (AED)")])),_:1,__:[44]}),s(e(x),{id:"deposit_amount",type:"number",step:"0.01",min:"0",modelValue:e(a).deposit_amount,"onUpdate:modelValue":t[10]||(t[10]=i=>e(a).deposit_amount=i)},null,8,["modelValue"]),e(a).errors.deposit_amount?(_(),m("div",At,u(e(a).errors.deposit_amount),1)):c("",!0)])]),E.value>0?(_(),m("div",Nt,[l("div",Ft,[t[45]||(t[45]=l("span",{class:"text-green-800 font-medium"},"Total Rental Amount:",-1)),l("span",It,u(b(E.value)),1)]),l("p",Tt,u(g.value)+" days Ã— "+u(b(e(a).daily_rate)),1)])):c("",!0),l("div",ht,[l("div",zt,[s(e(f),{for:"mileage_limit"},{default:o(()=>t[46]||(t[46]=[n("Mileage Limit (KM)")])),_:1,__:[46]}),s(e(x),{id:"mileage_limit",type:"number",min:"0",modelValue:e(a).mileage_limit,"onUpdate:modelValue":t[11]||(t[11]=i=>e(a).mileage_limit=i),placeholder:"Unlimited if not specified"},null,8,["modelValue"]),e(a).errors.mileage_limit?(_(),m("div",Mt,u(e(a).errors.mileage_limit),1)):c("",!0)]),l("div",Ot,[s(e(f),{for:"excess_mileage_rate"},{default:o(()=>t[47]||(t[47]=[n("Excess Mileage Rate (AED/KM)")])),_:1,__:[47]}),s(e(x),{id:"excess_mileage_rate",type:"number",step:"0.01",min:"0",modelValue:e(a).excess_mileage_rate,"onUpdate:modelValue":t[12]||(t[12]=i=>e(a).excess_mileage_rate=i)},null,8,["modelValue"]),e(a).errors.excess_mileage_rate?(_(),m("div",Bt,u(e(a).errors.excess_mileage_rate),1)):c("",!0)])])]),_:1})]),_:1}),s(e(C),null,{default:o(()=>[s(e(D),null,{default:o(()=>[s(e(V),{class:"flex items-center gap-2"},{default:o(()=>[s(e(Q),{class:"w-5 h-5"}),t[48]||(t[48]=n(" Terms & Notes "))]),_:1,__:[48]}),s(e($),null,{default:o(()=>t[49]||(t[49]=[n("Update contract terms and internal notes")])),_:1,__:[49]})]),_:1}),s(e(k),{class:"space-y-4"},{default:o(()=>[l("div",Pt,[s(e(f),{for:"terms_and_conditions"},{default:o(()=>t[50]||(t[50]=[n("Terms and Conditions")])),_:1,__:[50]}),s(e(F),{id:"terms_and_conditions",modelValue:e(a).terms_and_conditions,"onUpdate:modelValue":t[13]||(t[13]=i=>e(a).terms_and_conditions=i),placeholder:"Enter specific terms and conditions for this contract...",rows:"4"},null,8,["modelValue"]),e(a).errors.terms_and_conditions?(_(),m("div",Rt,u(e(a).errors.terms_and_conditions),1)):c("",!0)]),l("div",jt,[s(e(f),{for:"notes"},{default:o(()=>t[51]||(t[51]=[n("Internal Notes")])),_:1,__:[51]}),s(e(F),{id:"notes",modelValue:e(a).notes,"onUpdate:modelValue":t[14]||(t[14]=i=>e(a).notes=i),placeholder:"Add any internal notes about this contract...",rows:"3"},null,8,["modelValue"]),e(a).errors.notes?(_(),m("div",qt,u(e(a).errors.notes),1)):c("",!0)])]),_:1})]),_:1}),l("div",Kt,[s(e(N),{href:r.route("contracts.show",r.contract.id)},{default:o(()=>[s(e(p),{type:"button",variant:"outline"},{default:o(()=>t[52]||(t[52]=[n("Cancel")])),_:1,__:[52]})]),_:1},8,["href"]),s(e(p),{type:"submit",disabled:e(a).processing},{default:o(()=>[n(u(e(a).processing?"Updating...":"Update Contract"),1)]),_:1},8,["disabled"])])],32)])])]),_:1})],64))}});export{ne as default};

import{d as me,A as pe,r as x,c as Q,x as V,a as u,o as i,b as s,u as t,g as ce,e as l,f as o,j as b,m as f,t as d,h as r,F as h,l as $,n as fe,B as ve,i as X,k as _e,v as ye}from"./app-DguccfRE.js";import{_ as ge}from"./AppLayout.vue_vue_type_script_setup_true_lang-DjkdiIOr.js";import{c as te,_ as c}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-Bte1hcA2.js";import{_ as M}from"./Card.vue_vue_type_script_setup_true_lang-DIjkyD_w.js";import{_ as T,a as E,b as R}from"./CardTitle.vue_vue_type_script_setup_true_lang-NPYwaP62.js";import{_ as F}from"./CardDescription.vue_vue_type_script_setup_true_lang-CESbUQXI.js";import{_ as A}from"./Input.vue_vue_type_script_setup_true_lang--fTTb60R.js";import{_ as I}from"./Label.vue_vue_type_script_setup_true_lang-BQpmlyLl.js";import{_ as j,a as L,b as z,c as B}from"./DialogTitle.vue_vue_type_script_setup_true_lang-D6TWwVtf.js";import{_ as N,a as P}from"./DialogHeader.vue_vue_type_script_setup_true_lang-DqzFvIn5.js";import{C as q}from"./circle-check-big-BXDgF_bm.js";import{U as be}from"./user-plus-SOUia7U4.js";import{U as D}from"./user-BcSoTtFE.js";import{T as Z}from"./trash-2-C5NKD0jC.js";import{M as G}from"./mail-BRkQZI3M.js";import{D as U}from"./dollar-sign-BizzJXsF.js";import"./AppSidebarLayout.vue_vue_type_script_setup_true_lang-D57hGUko.js";import"./useForwardExpose-Cq7L2ISb.js";import"./RovingFocusGroup-BrlJi45z.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=te("CopyIcon",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=te("CrownIcon",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]),he={class:"p-6 space-y-6"},ke={key:0,class:"bg-green-50 border border-green-200 rounded-lg p-4"},we={class:"flex items-start gap-3"},Ce={class:"flex-1"},Se={class:"text-green-800 font-medium"},$e={class:"text-green-700 text-sm mt-1"},Ie={class:"mt-3 flex items-center gap-2"},Ue={class:"flex items-center justify-between"},Ve={class:"text-gray-600 mt-1"},Me={class:"space-y-4"},Te={class:"flex-1"},Re={class:"flex items-center gap-3"},Ae={class:"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center"},De={class:"font-medium"},Ee={class:"text-sm text-gray-600"},Fe={class:"text-xs text-gray-500"},je={class:"flex items-center gap-3"},Le={class:"relative"},ze=["value","onChange","disabled"],Be=["value"],Ne={key:1,class:"w-9 h-9"},Pe={key:0,class:"text-center py-8 text-gray-500"},qe={class:"space-y-4"},Ge={class:"flex-1"},Je={class:"flex items-center gap-3"},Ke={class:"font-medium"},Oe={class:"text-sm text-gray-600"},He={class:"text-xs text-gray-500"},We={class:"flex items-center gap-2"},Ye={class:"mt-6"},Qe={key:0,class:"text-sm text-red-600 mt-1"},Xe={class:"relative mt-2"},Ze=["value"],et={key:0,class:"text-sm text-red-600 mt-1"},tt={class:"space-y-4"},st={class:"space-y-2"},lt={class:"relative"},at={class:"space-y-2"},ot={class:"relative"},nt={class:"space-y-2"},rt={class:"relative"},Ut=me({__name:"TeamManagement",props:{team:{},members:{},pendingInvitations:{},availableRoles:{},canInviteUsers:{type:Boolean}},setup(it){const J=pe(),k=x(!1),w=x(!1),C=x(null),v=x(new Set),S=x(!1),_=x({public_key:"",secret_key:"",webhook_secret:""}),K=Q(()=>{var n,e;return((e=(n=J.props.auth)==null?void 0:n.user)==null?void 0:e.email)||""}),p=V({email:"",role:""}),O=V({role:""}),se=Q(()=>{var e,y;return(((y=(e=J.props.auth)==null?void 0:e.user)==null?void 0:y.roles)||[]).includes("Admin")}),le=n=>{switch(n){case"Admin":return xe;case"Finance":return U;case"Employee":return D;default:return D}},ae=n=>{switch(n){case"Admin":return"text-red-600 bg-red-100";case"Finance":return"text-green-600 bg-green-100";case"Employee":return"text-blue-600 bg-blue-100";default:return"text-gray-600 bg-gray-100"}},oe=()=>{p.post(route("team.invitations.send"),{onSuccess:()=>{p.reset(),k.value=!1}})},ne=(n,e)=>{O.role=e,O.patch(route("team.users.role",n.id),{preserveScroll:!0})},re=n=>{V({}).delete(route("team.invitations.cancel",n),{preserveScroll:!0})},ie=n=>{C.value=n,w.value=!0},de=()=>{C.value&&V({}).delete(route("team.users.remove",C.value.id),{onSuccess:()=>{w.value=!1,C.value=null}})},H=n=>new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),W=async(n,e)=>{try{await navigator.clipboard.writeText(n),v.value.add(e),setTimeout(()=>{v.value.delete(e)},2e3)}catch(y){console.error("Failed to copy: ",y);const g=document.createElement("textarea");g.value=n,document.body.appendChild(g),g.select(),document.execCommand("copy"),document.body.removeChild(g),v.value.add(e),setTimeout(()=>{v.value.delete(e)},2e3)}},ue=()=>{alert(`Stripe settings saved!
`+JSON.stringify(_.value,null,2)),S.value=!1};return(n,e)=>(i(),u(h,null,[s(t(ce),{title:"Team Management"}),s(ge,null,{default:l(()=>{var y,g;return[o("div",he,[(y=n.$page.props.flash)!=null&&y.success&&((g=n.$page.props.flash)!=null&&g.invitationUrl)?(i(),u("div",ke,[o("div",we,[s(t(q),{class:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}),o("div",Ce,[o("h3",Se,d(n.$page.props.flash.success),1),o("p",$e,[e[14]||(e[14]=r(" Invitation sent to ")),o("strong",null,d(n.$page.props.flash.invitationEmail),1)]),o("div",Ie,[s(t(c),{variant:"outline",size:"sm",onClick:e[0]||(e[0]=a=>W(n.$page.props.flash.invitationUrl,"flash-invitation")),class:"text-blue-600 hover:text-blue-700 hover:bg-blue-50"},{default:l(()=>[v.value.has("flash-invitation")?(i(),f(t(q),{key:0,class:"w-4 h-4 text-green-600"})):(i(),f(t(ee),{key:1,class:"w-4 h-4"})),r(" "+d(v.value.has("flash-invitation")?"Copied!":"Copy Invitation Link"),1)]),_:1})])])])])):b("",!0),o("div",Ue,[o("div",null,[e[15]||(e[15]=o("h1",{class:"text-3xl font-bold"},"Team Management",-1)),o("p",Ve," Manage your team members and their roles for "+d(n.team.name),1)]),n.canInviteUsers?(i(),f(t(c),{key:0,onClick:e[1]||(e[1]=a=>k.value=!0),class:"flex items-center gap-2"},{default:l(()=>[s(t(be),{class:"w-4 h-4"}),e[16]||(e[16]=r(" Invite Member "))]),_:1,__:[16]})):b("",!0)]),s(t(M),null,{default:l(()=>[s(t(T),null,{default:l(()=>[s(t(E),{class:"flex items-center gap-2"},{default:l(()=>[s(t(D),{class:"w-5 h-5"}),r(" Team Members ("+d(n.members.length)+") ",1)]),_:1}),s(t(F),null,{default:l(()=>e[17]||(e[17]=[r(" Current members of your team and their assigned roles ")])),_:1,__:[17]})]),_:1}),s(t(R),null,{default:l(()=>[o("div",Me,[(i(!0),u(h,null,$(n.members,a=>(i(),u("div",{key:a.id,class:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50"},[o("div",Te,[o("div",Re,[o("div",Ae,[s(t(D),{class:"w-5 h-5 text-gray-600"})]),o("div",null,[o("h3",De,d(a.name),1),o("p",Ee,d(a.email),1),o("p",Fe," Joined "+d(H(a.created_at)),1)])])]),o("div",je,[(i(!0),u(h,null,$(a.roles,m=>(i(),u("div",{key:m,class:fe(["flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium",ae(m)])},[(i(),f(ve(le(m)),{class:"w-3 h-3"})),r(" "+d(m),1)],2))),128)),o("div",Le,[o("select",{value:a.roles[0]||"",onChange:m=>ne(a,m.target.value),disabled:a.email===K.value,class:"flex h-9 w-32 rounded-md border border-input bg-background px-3 py-1 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},[e[18]||(e[18]=o("option",{value:"",disabled:""},"Select role",-1)),(i(!0),u(h,null,$(n.availableRoles,(m,Y)=>(i(),u("option",{key:Y,value:Y},d(m),9,Be))),128))],40,ze)]),a.email!==K.value?(i(),f(t(c),{key:0,variant:"outline",size:"sm",onClick:m=>ie(a),class:"text-red-600 hover:text-red-700 hover:bg-red-50"},{default:l(()=>[s(t(Z),{class:"w-4 h-4"})]),_:2},1032,["onClick"])):(i(),u("div",Ne))])]))),128)),n.members.length===0?(i(),u("div",Pe," No team members found. ")):b("",!0)])]),_:1})]),_:1}),n.pendingInvitations.length>0?(i(),f(t(M),{key:1},{default:l(()=>[s(t(T),null,{default:l(()=>[s(t(E),{class:"flex items-center gap-2"},{default:l(()=>[s(t(G),{class:"w-5 h-5"}),r(" Pending Invitations ("+d(n.pendingInvitations.length)+") ",1)]),_:1}),s(t(F),null,{default:l(()=>e[19]||(e[19]=[r(" Invitations that have been sent but not yet accepted ")])),_:1,__:[19]})]),_:1}),s(t(R),null,{default:l(()=>[o("div",qe,[(i(!0),u(h,null,$(n.pendingInvitations,a=>(i(),u("div",{key:a.id,class:"flex items-center justify-between p-4 border rounded-lg bg-yellow-50 border-yellow-200"},[o("div",Ge,[o("div",Je,[s(t(G),{class:"w-5 h-5 text-yellow-600"}),o("div",null,[o("h3",Ke,d(a.email),1),o("p",Oe," Invited by "+d(a.invited_by)+" â€¢ Role: "+d(a.role),1),o("p",He," Expires "+d(H(a.expires_at)),1)])])]),o("div",We,[s(t(c),{variant:"outline",size:"sm",onClick:m=>W(a.invitation_url,`invitation-${a.id}`),class:"text-blue-600 hover:text-blue-700 hover:bg-blue-50"},{default:l(()=>[v.value.has(`invitation-${a.id}`)?(i(),f(t(q),{key:0,class:"w-4 h-4 text-green-600"})):(i(),f(t(ee),{key:1,class:"w-4 h-4"})),r(" "+d(v.value.has(`invitation-${a.id}`)?"Copied!":"Copy Link"),1)]),_:2},1032,["onClick"]),s(t(c),{variant:"outline",size:"sm",onClick:m=>re(a.id),class:"text-red-600 hover:text-red-700 hover:bg-red-50"},{default:l(()=>[s(t(Z),{class:"w-4 h-4"}),e[20]||(e[20]=r(" Cancel "))]),_:2,__:[20]},1032,["onClick"])])]))),128))])]),_:1})]),_:1})):b("",!0),s(t(j),{open:k.value,"onUpdate:open":e[5]||(e[5]=a=>k.value=a)},{default:l(()=>[s(t(L),{class:"sm:max-w-md"},{default:l(()=>[s(t(N),{class:"space-y-3"},{default:l(()=>[s(t(z),null,{default:l(()=>e[21]||(e[21]=[r("Invite Team Member")])),_:1,__:[21]}),s(t(B),null,{default:l(()=>[r(" Send an invitation to join "+d(n.team.name)+". They will receive an email with instructions to create their account. ",1)]),_:1})]),_:1}),o("div",Ye,[o("form",{onSubmit:X(oe,["prevent"]),class:"space-y-6"},[o("div",null,[s(t(I),{for:"email"},{default:l(()=>e[22]||(e[22]=[r("Email Address")])),_:1,__:[22]}),s(t(A),{id:"email",modelValue:t(p).email,"onUpdate:modelValue":e[2]||(e[2]=a=>t(p).email=a),type:"email",placeholder:"Enter email address",required:"",disabled:t(p).processing,class:"mt-2"},null,8,["modelValue","disabled"]),t(p).errors.email?(i(),u("div",Qe,d(t(p).errors.email),1)):b("",!0)]),o("div",null,[s(t(I),{for:"role"},{default:l(()=>e[23]||(e[23]=[r("Role")])),_:1,__:[23]}),o("div",Xe,[_e(o("select",{"onUpdate:modelValue":e[3]||(e[3]=a=>t(p).role=a),required:"",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},[e[24]||(e[24]=o("option",{value:"",disabled:""},"Select a role",-1)),(i(!0),u(h,null,$(n.availableRoles,(a,m)=>(i(),u("option",{key:m,value:m},d(a),9,Ze))),128))],512),[[ye,t(p).role]])]),t(p).errors.role?(i(),u("div",et,d(t(p).errors.role),1)):b("",!0)]),s(t(P),{class:"pt-4"},{default:l(()=>[s(t(c),{type:"button",variant:"outline",onClick:e[4]||(e[4]=a=>k.value=!1)},{default:l(()=>e[25]||(e[25]=[r(" Cancel ")])),_:1,__:[25]}),s(t(c),{type:"submit",disabled:t(p).processing},{default:l(()=>[r(d(t(p).processing?"Sending...":"Send Invitation"),1)]),_:1},8,["disabled"])]),_:1})],32)])]),_:1})]),_:1},8,["open"]),s(t(j),{open:w.value,"onUpdate:open":e[7]||(e[7]=a=>w.value=a)},{default:l(()=>[s(t(L),{class:"sm:max-w-md"},{default:l(()=>[s(t(N),null,{default:l(()=>[s(t(z),null,{default:l(()=>e[26]||(e[26]=[r("Remove Team Member")])),_:1,__:[26]}),s(t(B),null,{default:l(()=>{var a;return[r(" Are you sure you want to remove "+d((a=C.value)==null?void 0:a.name)+" from the team? This action cannot be undone. ",1)]}),_:1})]),_:1}),s(t(P),null,{default:l(()=>[s(t(c),{type:"button",variant:"outline",onClick:e[6]||(e[6]=a=>w.value=!1)},{default:l(()=>e[27]||(e[27]=[r(" Cancel ")])),_:1,__:[27]}),s(t(c),{type:"button",variant:"destructive",onClick:de},{default:l(()=>e[28]||(e[28]=[r(" Remove Member ")])),_:1,__:[28]})]),_:1})]),_:1})]),_:1},8,["open"]),se.value?(i(),f(t(M),{key:2},{default:l(()=>[s(t(T),null,{default:l(()=>[s(t(E),{class:"flex items-center gap-2"},{default:l(()=>[s(t(U),{class:"w-5 h-5 text-purple-600"}),e[29]||(e[29]=r(" Stripe Payment Gateway Setup "))]),_:1,__:[29]}),s(t(F),null,{default:l(()=>e[30]||(e[30]=[r(" Connect and configure your Stripe account to enable online payments for your team. ")])),_:1,__:[30]})]),_:1}),s(t(R),null,{default:l(()=>[o("div",tt,[e[32]||(e[32]=o("p",{class:"text-gray-700"},"To accept payments online, you need to connect your Stripe account. Only admins can see and manage this section.",-1)),s(t(c),{variant:"outline",class:"text-purple-700 border-purple-300 hover:bg-purple-50",onClick:e[8]||(e[8]=a=>S.value=!0)},{default:l(()=>e[31]||(e[31]=[r(" Connect Stripe Account ")])),_:1,__:[31]})])]),_:1})]),_:1})):b("",!0),s(t(j),{open:S.value,"onUpdate:open":e[13]||(e[13]=a=>S.value=a)},{default:l(()=>[s(t(L),{class:"max-w-md w-full p-0"},{default:l(()=>[s(t(M),{class:"shadow-none border-0"},{default:l(()=>[s(t(T),{class:"pb-0"},{default:l(()=>[s(t(N),null,{default:l(()=>[s(t(z),{class:"flex items-center gap-2"},{default:l(()=>[s(t(U),{class:"w-5 h-5 text-purple-600"}),e[33]||(e[33]=r(" Stripe Payment Gateway Setup "))]),_:1,__:[33]}),s(t(B),null,{default:l(()=>e[34]||(e[34]=[r(" Enter your Stripe API keys to enable online payments. You can find these in your Stripe dashboard. ")])),_:1,__:[34]})]),_:1})]),_:1}),s(t(R),{class:"pt-0"},{default:l(()=>[o("form",{onSubmit:X(ue,["prevent"]),class:"space-y-5 mt-2"},[o("div",st,[s(t(I),{for:"stripe-public-key"},{default:l(()=>e[35]||(e[35]=[r("Stripe Public Key")])),_:1,__:[35]}),o("div",lt,[s(t(A),{id:"stripe-public-key",modelValue:_.value.public_key,"onUpdate:modelValue":e[9]||(e[9]=a=>_.value.public_key=a),type:"text",required:"",placeholder:"pk_live_...",class:"pr-10"},null,8,["modelValue"]),s(t(U),{class:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none"})])]),o("div",at,[s(t(I),{for:"stripe-secret-key"},{default:l(()=>e[36]||(e[36]=[r("Stripe Secret Key")])),_:1,__:[36]}),o("div",ot,[s(t(A),{id:"stripe-secret-key",modelValue:_.value.secret_key,"onUpdate:modelValue":e[10]||(e[10]=a=>_.value.secret_key=a),type:"text",required:"",placeholder:"sk_live_...",class:"pr-10"},null,8,["modelValue"]),s(t(U),{class:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none"})])]),o("div",nt,[s(t(I),{for:"stripe-webhook-secret"},{default:l(()=>e[37]||(e[37]=[r("Webhook Secret")])),_:1,__:[37]}),o("div",rt,[s(t(A),{id:"stripe-webhook-secret",modelValue:_.value.webhook_secret,"onUpdate:modelValue":e[11]||(e[11]=a=>_.value.webhook_secret=a),type:"text",required:"",placeholder:"whsec_...",class:"pr-10"},null,8,["modelValue"]),s(t(G),{class:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none"})])]),s(t(P),{class:"flex justify-end gap-2 pt-4"},{default:l(()=>[s(t(c),{type:"button",variant:"outline",onClick:e[12]||(e[12]=a=>S.value=!1)},{default:l(()=>e[38]||(e[38]=[r("Cancel")])),_:1,__:[38]}),s(t(c),{type:"submit"},{default:l(()=>e[39]||(e[39]=[r("Save")])),_:1,__:[39]})]),_:1})],32)]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])])]}),_:1})],64))}});export{Ut as default};

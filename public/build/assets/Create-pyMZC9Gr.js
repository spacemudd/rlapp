import{d as G,x as K,p as I,w as U,r as Q,f as X,o as h,b as u,e as s,a as r,u as o,S as tt,j as et,i as m,c as D,h as R,k as w,F as M,m as S,t as x,v as A,n as st,l as $}from"./app-B0Y7WZKT.js";import{_ as nt}from"./AppSidebarLayout.vue_vue_type_script_setup_true_lang-C9UPZ3OS.js";import{_ as L}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CdW4O66k.js";import{_ as N}from"./Input.vue_vue_type_script_setup_true_lang-B4KzdOqg.js";import{_ as g}from"./Label.vue_vue_type_script_setup_true_lang-BMisPlcK.js";import{_ as F,a as H,b as q,c as Y}from"./CardTitle.vue_vue_type_script_setup_true_lang-DBaR-C81.js";import{_ as z}from"./CardDescription.vue_vue_type_script_setup_true_lang-CVuUofmO.js";import{n as ot,d as at,c as it,t as O,m as W,a as j,f as T}from"./format-Bw_hER4B.js";import{A as dt}from"./arrow-left-B9Mx02ry.js";import{D as Z}from"./dollar-sign-Z-IaoCJd.js";import{U as lt}from"./user-BSiUGR4Y.js";import"./useForwardExpose-CwVdPpiZ.js";import"./RovingFocusGroup-CiOKQAuO.js";function B(i,n,e){const[d,c]=ot(e==null?void 0:e.in,i,n),f=P(d,c),v=Math.abs(at(d,c));d.setDate(d.getDate()-f*v);const y=+(P(d,c)===-f),_=f*(v-y);return _===0?0:_}function P(i,n){const e=i.getFullYear()-n.getFullYear()||i.getMonth()-n.getMonth()||i.getDate()-n.getDate()||i.getHours()-n.getHours()||i.getMinutes()-n.getMinutes()||i.getSeconds()-n.getSeconds()||i.getMilliseconds()-n.getMilliseconds();return e<0?-1:e>0?1:e}function C(i,n){const e=()=>it(n==null?void 0:n.in,NaN),c=mt(i);let f;if(c.date){const l=ft(c.date,2);f=pt(l.restDateString,l.year)}if(!f||isNaN(+f))return e();const v=+f;let y=0,_;if(c.time&&(y=_t(c.time),isNaN(y)))return e();if(c.timezone){if(_=gt(c.timezone),isNaN(_))return e()}else{const l=new Date(v+y),t=O(0,n==null?void 0:n.in);return t.setFullYear(l.getUTCFullYear(),l.getUTCMonth(),l.getUTCDate()),t.setHours(l.getUTCHours(),l.getUTCMinutes(),l.getUTCSeconds(),l.getUTCMilliseconds()),t}return O(v+y+_,n==null?void 0:n.in)}const k={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},rt=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,ut=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,ct=/^([+-])(\d{2})(?::?(\d{2}))?$/;function mt(i){const n={},e=i.split(k.dateTimeDelimiter);let d;if(e.length>2)return n;if(/:/.test(e[0])?d=e[0]:(n.date=e[0],d=e[1],k.timeZoneDelimiter.test(n.date)&&(n.date=i.split(k.timeZoneDelimiter)[0],d=i.substr(n.date.length,i.length))),d){const c=k.timezone.exec(d);c?(n.time=d.replace(c[1],""),n.timezone=c[1]):n.time=d}return n}function ft(i,n){const e=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+n)+"})|(\\d{2}|[+-]\\d{"+(2+n)+"})$)"),d=i.match(e);if(!d)return{year:NaN,restDateString:""};const c=d[1]?parseInt(d[1]):null,f=d[2]?parseInt(d[2]):null;return{year:f===null?c:f*100,restDateString:i.slice((d[1]||d[2]).length)}}function pt(i,n){if(n===null)return new Date(NaN);const e=i.match(rt);if(!e)return new Date(NaN);const d=!!e[4],c=V(e[1]),f=V(e[2])-1,v=V(e[3]),y=V(e[4]),_=V(e[5])-1;if(d)return ht(n,y,_)?yt(n,y,_):new Date(NaN);{const l=new Date(0);return!bt(n,f,v)||!xt(n,c)?new Date(NaN):(l.setUTCFullYear(n,f,Math.max(c,v)),l)}}function V(i){return i?parseInt(i):1}function _t(i){const n=i.match(ut);if(!n)return NaN;const e=E(n[1]),d=E(n[2]),c=E(n[3]);return Dt(e,d,c)?e*W+d*j+c*1e3:NaN}function E(i){return i&&parseFloat(i.replace(",","."))||0}function gt(i){if(i==="Z")return 0;const n=i.match(ct);if(!n)return 0;const e=n[1]==="+"?-1:1,d=parseInt(n[2]),c=n[3]&&parseInt(n[3])||0;return Nt(d,c)?e*(d*W+c*j):NaN}function yt(i,n,e){const d=new Date(0);d.setUTCFullYear(i,0,4);const c=d.getUTCDay()||7,f=(n-1)*7+e+1-c;return d.setUTCDate(d.getUTCDate()+f),d}const vt=[31,null,31,30,31,30,31,31,30,31,30,31];function J(i){return i%400===0||i%4===0&&i%100!==0}function bt(i,n,e){return n>=0&&n<=11&&e>=1&&e<=(vt[n]||(J(i)?29:28))}function xt(i,n){return n>=1&&n<=(J(i)?366:365)}function ht(i,n,e){return n>=1&&n<=53&&e>=0&&e<=6}function Dt(i,n,e){return i===24?n===0&&e===0:e>=0&&e<60&&n>=0&&n<60&&i>=0&&i<25}function Nt(i,n){return n>=0&&n<=59}const wt={class:"container mx-auto p-6 max-w-7xl"},Vt={class:"flex items-center justify-between mb-8"},Ut={class:"flex items-center gap-4"},Tt={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},Ct={class:"space-y-2"},kt=["value"],It={class:"space-y-2"},Mt={class:"space-y-2"},St={class:"grid grid-cols-2 gap-4"},At={class:"space-y-2"},$t={class:"space-y-2"},Ft={class:"relative"},Ht={key:0,class:"mt-6 space-y-4"},qt={class:"flex items-center gap-2"},Yt={class:"grid grid-cols-2 gap-4"},zt={class:"space-y-1"},Et={class:"text-sm font-medium"},Rt={class:"space-y-1"},Lt={class:"text-sm font-medium"},Ot={class:"space-y-1"},Zt={class:"text-sm font-medium"},Bt={class:"space-y-1"},Pt={class:"text-sm font-medium"},Wt={class:"space-y-1"},jt={class:"text-sm font-medium"},Jt={class:"space-y-2"},Gt=["value"],Kt={class:"grid grid-cols-2 gap-4"},Qt={class:"space-y-2"},Xt={class:"space-y-2"},te={class:"space-y-2"},ee={class:"w-full mt-10"},se={class:"bg-white rounded-lg shadow border"},ne={class:"w-full text-sm"},oe={class:"px-4 py-2"},ae=["onUpdate:modelValue","readonly","required"],ie={class:"px-4 py-2 text-center"},de=["onUpdate:modelValue"],le={class:"px-4 py-2 text-center"},re=["onUpdate:modelValue"],ue={class:"px-4 py-2 text-right font-semibold"},ce={class:"px-2 py-2 text-center"},me=["onClick"],fe={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},pe={class:"space-y-2"},_e={class:"relative"},ge={class:"space-y-2"},ye={class:"space-y-2"},ve={class:"input w-full bg-gray-50"},be={class:"flex justify-end mt-8"},Ae=G({__name:"Create",props:{customers:{},vehicles:{},nextInvoiceNumber:{}},setup(i){const n=i,e=K({invoice_date:T(new Date,"yyyy-MM-dd'T'HH:mm"),due_date:T(new Date,"yyyy-MM-dd'T'HH:mm"),status:"unpaid",currency:"AED",total_days:0,start_datetime:T(new Date,"yyyy-MM-dd'T'HH:mm"),end_datetime:T(new Date,"yyyy-MM-dd'T'HH:mm"),vehicle_id:"",customer_id:"",sub_total:0,total_discount:0,total_amount:0,items:[{description:"",amount:0,discount:0}]}),d=I(()=>n.customers.find(l=>l.id===e.customer_id)||null),c=I(()=>e.items.reduce((l,t)=>l+(Number(t.amount||0)-Number(t.discount||0)),0));I(()=>c.value-Number(e.total_amount||0)),U(()=>e.items,l=>{const t=l;e.sub_total=t.reduce((a,p)=>a+(Number(p.amount)||0),0),e.total_discount=t.reduce((a,p)=>a+(Number(p.discount)||0),0),e.total_amount=e.sub_total-e.total_discount},{deep:!0}),U(()=>e.status,l=>{l==="paid"&&(e.total_amount=0)}),U([()=>e.start_datetime,()=>e.end_datetime],([l,t])=>{if(l&&t){const a=C(l),p=C(t),b=B(p,a);e.total_days=Math.max(0,b)}}),U(()=>e.vehicle_id,l=>{const t=e.items;if(l){const a=n.vehicles.find(p=>p.id===l);if(a){const p=t.findIndex(b=>b.isVehicle);p!==-1?t[p].description=a.name:t.unshift({description:a.name,amount:0,discount:0,isVehicle:!0})}}else{const a=t.findIndex(p=>p.isVehicle);a!==-1&&t.splice(a,1)}});const f=()=>{const l=e.items;e.sub_total=l.reduce((t,a)=>t+(Number(a.amount)||0),0),e.total_discount=l.reduce((t,a)=>t+(Number(a.discount)||0),0),e.total_amount=e.sub_total-e.total_discount,e.items=l.map(t=>({description:t.description||"",amount:Number(t.amount)||0,discount:Number(t.discount)||0})),e.post(route("invoices.store"),{onSuccess:()=>{},onError:t=>{console.error("Form submission errors:",t)}})};Q([{id:"1",name:"Sales"},{id:"2",name:"Services"}]);function v(){e.items.push({description:"",amount:0,discount:0})}function y(l){const t=e.items;t[l]&&t[l].isVehicle||t.splice(l,1)}function _(){if(e.start_datetime&&e.end_datetime){const l=C(e.start_datetime),t=C(e.end_datetime),a=B(t,l);e.total_days=Math.max(0,a)}}return(l,t)=>(h(),X(nt,null,{default:u(()=>[s("div",wt,[s("div",Vt,[s("div",Ut,[r(o(L),{variant:"ghost",size:"icon","as-child":"",class:"hover:bg-gray-100"},{default:u(()=>[r(o(tt),{href:l.route("invoices")},{default:u(()=>[r(o(dt),{class:"h-5 w-5"})]),_:1},8,["href"])]),_:1}),t[9]||(t[9]=s("div",null,[s("h1",{class:"text-2xl font-semibold tracking-tight"},"Create New Invoice"),s("p",{class:"text-sm text-gray-500 mt-1"},"Fill in the details below to create a new invoice")],-1))])]),s("form",{id:"invoice-form",onSubmit:et(f,["prevent"]),class:"space-y-8"},[s("div",Tt,[r(o(F),{class:"border-none shadow-md"},{default:u(()=>[r(o(H),{class:"pb-4"},{default:u(()=>[r(o(q),{class:"text-lg font-medium"},{default:u(()=>t[10]||(t[10]=[m("Basic Information")])),_:1,__:[10]}),r(o(z),null,{default:u(()=>t[11]||(t[11]=[m("Enter the basic details of the invoice")])),_:1,__:[11]})]),_:1}),r(o(Y),{class:"space-y-6"},{default:u(()=>[s("div",Ct,[r(o(g),{for:"customer_id",class:"text-sm font-medium"},{default:u(()=>t[12]||(t[12]=[m("Customer")])),_:1,__:[12]}),w(s("select",{id:"customer_id","onUpdate:modelValue":t[0]||(t[0]=a=>o(e).customer_id=a),required:"",class:"w-full h-10 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2"},[t[13]||(t[13]=s("option",{value:""},"Select a customer",-1)),(h(!0),D(M,null,S(l.customers,a=>(h(),D("option",{key:a.id,value:a.id},x(a.name)+" - "+x(a.email),9,kt))),128))],512),[[A,o(e).customer_id]])]),s("div",It,[r(o(g),{for:"invoice_date",class:"text-sm font-medium"},{default:u(()=>t[14]||(t[14]=[m("Invoice Date")])),_:1,__:[14]}),r(o(N),{type:"datetime-local",id:"invoice_date",modelValue:o(e).invoice_date,"onUpdate:modelValue":t[1]||(t[1]=a=>o(e).invoice_date=a),required:"",class:"h-10"},null,8,["modelValue"])]),s("div",Mt,[r(o(g),{for:"due_date",class:"text-sm font-medium"},{default:u(()=>t[15]||(t[15]=[m("Due Date")])),_:1,__:[15]}),r(o(N),{type:"datetime-local",id:"due_date",modelValue:o(e).due_date,"onUpdate:modelValue":t[2]||(t[2]=a=>o(e).due_date=a),required:"",class:"h-10"},null,8,["modelValue"])]),s("div",St,[s("div",At,[r(o(g),{for:"status",class:"text-sm font-medium"},{default:u(()=>t[16]||(t[16]=[m("Status")])),_:1,__:[16]}),w(s("select",{id:"status","onUpdate:modelValue":t[3]||(t[3]=a=>o(e).status=a),class:"w-full h-10 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2"},t[17]||(t[17]=[s("option",{value:"unpaid"},"Unpaid",-1),s("option",{value:"paid"},"Paid",-1),s("option",{value:"partial_paid"},"Partial Paid",-1)]),512),[[A,o(e).status]])]),s("div",$t,[r(o(g),{for:"currency",class:"text-sm font-medium"},{default:u(()=>t[18]||(t[18]=[m("Currency")])),_:1,__:[18]}),s("div",Ft,[r(o(Z),{class:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"}),r(o(N),{id:"currency",modelValue:o(e).currency,"onUpdate:modelValue":t[4]||(t[4]=a=>o(e).currency=a),required:"",class:"h-10 pl-10"},null,8,["modelValue"])])])]),d.value?(h(),D("div",Ht,[s("div",qt,[r(o(lt),{class:"h-5 w-5 text-gray-400"}),t[19]||(t[19]=s("h3",{class:"text-sm font-medium"},"Customer Information",-1))]),s("div",Yt,[s("div",zt,[t[20]||(t[20]=s("p",{class:"text-sm text-gray-500"},"Name",-1)),s("p",Et,x(d.value.name),1)]),s("div",Rt,[t[21]||(t[21]=s("p",{class:"text-sm text-gray-500"},"Email",-1)),s("p",Lt,x(d.value.email),1)]),s("div",Ot,[t[22]||(t[22]=s("p",{class:"text-sm text-gray-500"},"Phone",-1)),s("p",Zt,x(d.value.phone||"N/A"),1)]),s("div",Bt,[t[23]||(t[23]=s("p",{class:"text-sm text-gray-500"},"License Number",-1)),s("p",Pt,x(d.value.drivers_license_number||"N/A"),1)])]),s("div",Wt,[t[24]||(t[24]=s("p",{class:"text-sm text-gray-500"},"Address",-1)),s("p",jt,x(d.value.address?`${d.value.address}, ${d.value.city}, ${d.value.country}`:"N/A"),1)])])):R("",!0)]),_:1})]),_:1}),r(o(F),{class:"border-none shadow-md"},{default:u(()=>[r(o(H),{class:"pb-4"},{default:u(()=>[r(o(q),{class:"text-lg font-medium"},{default:u(()=>t[25]||(t[25]=[m("Rental Details")])),_:1,__:[25]}),r(o(z),null,{default:u(()=>t[26]||(t[26]=[m("Enter the rental period and related information")])),_:1,__:[26]})]),_:1}),r(o(Y),{class:"space-y-6"},{default:u(()=>[s("div",Jt,[r(o(g),{for:"vehicle_id",class:"text-sm font-medium"},{default:u(()=>t[27]||(t[27]=[m("Vehicle")])),_:1,__:[27]}),w(s("select",{id:"vehicle_id","onUpdate:modelValue":t[5]||(t[5]=a=>o(e).vehicle_id=a),required:"",class:"w-full h-10 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2"},[t[28]||(t[28]=s("option",{value:""},"Select a vehicle",-1)),(h(!0),D(M,null,S(n.vehicles,a=>(h(),D("option",{key:a.id,value:a.id},x(a.name),9,Gt))),128))],512),[[A,o(e).vehicle_id]])]),s("div",Kt,[s("div",Qt,[r(o(g),{for:"start_datetime",class:"text-sm font-medium"},{default:u(()=>t[29]||(t[29]=[m("Start Date & Time")])),_:1,__:[29]}),r(o(N),{type:"datetime-local",id:"start_datetime",modelValue:o(e).start_datetime,"onUpdate:modelValue":t[6]||(t[6]=a=>o(e).start_datetime=a),required:"",class:"h-10",onChange:_},null,8,["modelValue"])]),s("div",Xt,[r(o(g),{for:"end_datetime",class:"text-sm font-medium"},{default:u(()=>t[30]||(t[30]=[m("End Date & Time")])),_:1,__:[30]}),r(o(N),{type:"datetime-local",id:"end_datetime",modelValue:o(e).end_datetime,"onUpdate:modelValue":t[7]||(t[7]=a=>o(e).end_datetime=a),required:"",class:"h-10",onChange:_},null,8,["modelValue"])])]),s("div",te,[r(o(g),{for:"total_days",class:"text-sm font-medium"},{default:u(()=>t[31]||(t[31]=[m("Total Days")])),_:1,__:[31]}),r(o(N),{type:"number",id:"total_days",modelValue:o(e).total_days,"onUpdate:modelValue":t[8]||(t[8]=a=>o(e).total_days=a),required:"",class:"h-10",readonly:""},null,8,["modelValue"])])]),_:1})]),_:1})]),s("div",ee,[s("div",se,[s("table",ne,[t[32]||(t[32]=s("thead",{class:"bg-gray-50 border-b"},[s("tr",null,[s("th",{class:"px-4 py-3 text-left font-semibold text-gray-700"},[m("Description"),s("span",{class:"text-red-500"},"*")]),s("th",{class:"px-4 py-3 text-center font-semibold text-gray-700"},[m("Amount"),s("span",{class:"text-red-500"},"*")]),s("th",{class:"px-4 py-3 text-center font-semibold text-gray-700"},"Discount"),s("th",{class:"px-4 py-3 text-right font-semibold text-gray-700"},"Total"),s("th",{class:"px-4 py-3"})])],-1)),s("tbody",null,[(h(!0),D(M,null,S(o(e).items,(a,p)=>(h(),D("tr",{key:p,class:"border-b hover:bg-gray-50"},[s("td",oe,[w(s("input",{"onUpdate:modelValue":b=>a.description=b,readonly:a.isVehicle,class:st(["w-full border rounded px-2 py-1 focus:ring-2 focus:ring-blue-200 focus:border-blue-400 transition",{"bg-gray-100 cursor-not-allowed":a.isVehicle}]),placeholder:"Description",required:p===0},null,10,ae),[[$,a.description]])]),s("td",ie,[w(s("input",{"onUpdate:modelValue":b=>a.amount=b,type:"number",min:"0",step:"0.01",class:"w-28 border rounded px-2 py-1 text-center focus:ring-2 focus:ring-blue-200 focus:border-blue-400 transition",required:""},null,8,de),[[$,a.amount,void 0,{number:!0}]])]),s("td",le,[w(s("input",{"onUpdate:modelValue":b=>a.discount=b,type:"number",min:"0",step:"0.01",class:"w-24 border rounded px-2 py-1 text-center focus:ring-2 focus:ring-blue-200 focus:border-blue-400 transition",placeholder:"0.00"},null,8,re),[[$,a.discount,void 0,{number:!0}]])]),s("td",ue,x((a.amount-a.discount).toFixed(2)),1),s("td",ce,[a.isVehicle?R("",!0):(h(),D("button",{key:0,type:"button",onClick:b=>y(p),class:"text-red-500 hover:text-red-700 font-bold text-lg",title:"Remove"}," × ",8,me))])]))),128))])]),s("div",{class:"px-4 py-3 bg-gray-50 rounded-b-lg flex justify-between items-center"},[s("button",{type:"button",class:"text-blue-600 hover:underline font-medium",onClick:v}," + Item ")])])]),r(o(F),{class:"border-none shadow-md lg:col-span-2"},{default:u(()=>[r(o(H),{class:"pb-4"},{default:u(()=>[r(o(q),{class:"text-lg font-medium"},{default:u(()=>t[33]||(t[33]=[m("Financial Details")])),_:1,__:[33]}),r(o(z),null,{default:u(()=>t[34]||(t[34]=[m("Enter the payment and amount information")])),_:1,__:[34]})]),_:1}),r(o(Y),null,{default:u(()=>[s("div",fe,[s("div",pe,[r(o(g),{for:"invoice_amount",class:"text-sm font-medium"},{default:u(()=>t[35]||(t[35]=[m("Invoice Amount")])),_:1,__:[35]}),s("div",_e,[r(o(Z),{class:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"}),r(o(N),{id:"invoice_amount",value:c.value.toFixed(2),readonly:"",class:"h-10 pl-10 bg-gray-100 cursor-not-allowed"},null,8,["value"])])]),s("div",ge,[r(o(g),{class:"block text-sm font-medium mb-1"},{default:u(()=>t[36]||(t[36]=[m("Paid Amount")])),_:1,__:[36]}),t[37]||(t[37]=s("div",{class:"input w-full bg-gray-50"},"0",-1))]),s("div",ye,[r(o(g),{class:"block text-sm font-medium mb-1"},{default:u(()=>t[38]||(t[38]=[m("Remaining Amount")])),_:1,__:[38]}),s("div",ve,x(o(e).total_amount),1)])])]),_:1})]),_:1}),s("div",be,[r(o(L),{type:"submit",form:"invoice-form",disabled:o(e).processing},{default:u(()=>t[39]||(t[39]=[m(" Create ")])),_:1,__:[39]},8,["disabled"])])],32)])]),_:1}))}});export{Ae as default};

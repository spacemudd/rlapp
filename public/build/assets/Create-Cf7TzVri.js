import{y as ce,x as _e,r as x,p as pe,z as R,A as fe,c as m,o as u,d as l,u as t,B as ve,w as r,a as s,S as J,e as d,t as i,f as ge,b as ye,g as c,F as L,h as xe,i as be,l as he,J as we}from"./app-DGPdy8tE.js";import{_ as ke}from"./AppLayout.vue_vue_type_script_setup_true_lang-DjXAUWl4.js";import{_ as C}from"./Card.vue_vue_type_script_setup_true_lang-Co6J2EDk.js";import{_ as D}from"./CardContent.vue_vue_type_script_setup_true_lang-Du459S1j.js";import{_ as V}from"./CardDescription.vue_vue_type_script_setup_true_lang-KpDHoYXP.js";import{_ as T,a as S}from"./CardTitle.vue_vue_type_script_setup_true_lang-B5rRz984.js";import{_ as O}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CNQnzH42.js";import{_ as b}from"./Input.vue_vue_type_script_setup_true_lang-D-rdJcos.js";import{_ as g}from"./Label.vue_vue_type_script_setup_true_lang-CVb8RRH_.js";import{_ as W}from"./Textarea.vue_vue_type_script_setup_true_lang-DkdQ9_uS.js";import{_ as Ce,a as De,b as Ve,c as Te}from"./DialogTitle.vue_vue_type_script_setup_true_lang-n__8TIm7.js";import{_ as Se}from"./DialogHeader.vue_vue_type_script_setup_true_lang-CRpOQyG4.js";import{_ as Ue}from"./DialogTrigger.vue_vue_type_script_setup_true_lang-C-7VcIWj.js";import{_ as X}from"./AsyncCombobox.vue_vue_type_script_setup_true_lang-cBFMRowo.js";import{_ as Ee}from"./CreateCustomerForm.vue_vue_type_script_setup_true_lang-BJWdYCa8.js";import{A as Me}from"./arrow-left-BcJtCQ4-.js";import{U as $e}from"./user-CubPX3qw.js";import{P as Ae}from"./plus-qOnMRLUf.js";import{C as Fe,F as je}from"./AppSidebarLayout.vue_vue_type_script_setup_true_lang-CiHZFCnI.js";import{C as Pe}from"./calendar-Ddrjuz5x.js";import{D as Ne}from"./dollar-sign-D8aiooa7.js";import"./useForwardExpose-C0eXaZLz.js";import"./RovingFocusGroup-ChOkdtX6.js";import"./check-hjMUVb_a.js";import"./InputError.vue_vue_type_script_setup_true_lang-CcFsNVLB.js";const Re={class:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4"},Le={class:"space-y-6"},Oe={class:"flex items-center justify-between"},Be={class:"text-right"},qe={class:"text-gray-600 mt-1"},ze={class:"grid gap-6 lg:grid-cols-2"},Ie={class:"pt-4 border-t"},Ge={class:"flex items-center justify-between"},He={key:0,class:"p-3 bg-gray-50 rounded-md"},Ke={class:"grid grid-cols-3 gap-2 text-sm"},Je={class:"font-medium"},We={class:"font-medium"},Xe={class:"font-medium"},Ye={class:"grid gap-4 md:grid-cols-2"},Ze={class:"space-y-2"},Qe={key:0,class:"text-sm text-red-600"},et={class:"space-y-2"},tt={key:0,class:"text-sm text-red-600"},st={class:"space-y-3"},ot={class:"grid gap-4 md:grid-cols-3"},lt={class:"space-y-2"},at={class:"md:col-span-2 flex items-end"},rt={class:"p-3 bg-blue-50 rounded-md w-full"},nt={class:"text-sm text-blue-800"},it={key:0,class:"block text-xs mt-1"},dt={class:"grid gap-4 md:grid-cols-2"},ut={class:"space-y-2"},mt={key:0,class:"text-sm text-red-600"},ct={class:"space-y-2"},_t={key:0,class:"text-sm text-red-600"},pt={key:0,class:"p-4 bg-blue-50 border border-blue-200 rounded-md"},ft={key:1,class:"p-4 bg-green-50 border border-green-200 rounded-md"},vt={class:"flex justify-between items-center"},gt={class:"text-2xl font-bold text-green-900"},yt={class:"flex justify-between items-center text-sm text-green-700 mt-2"},xt={key:0,class:"mt-3 pt-3 border-t border-green-200"},bt={class:"space-y-1 text-sm text-green-700"},ht={key:0,class:"flex justify-between"},wt={key:0,class:"flex justify-between"},kt={key:1,class:"flex justify-between"},Ct={key:0,class:"flex justify-between"},Dt={key:1,class:"flex justify-between"},Vt={key:2,class:"flex justify-between"},Tt={class:"grid gap-4 md:grid-cols-2"},St={class:"space-y-2"},Ut={key:0,class:"text-sm text-red-600"},Et={class:"space-y-2"},Mt={key:0,class:"text-sm text-red-600"},$t={class:"grid gap-4 md:grid-cols-2"},At={class:"space-y-2"},Ft={key:0,class:"text-sm text-red-600"},jt={class:"space-y-2"},Pt={key:0,class:"text-sm text-red-600"},Nt={class:"space-y-3"},Rt={class:"flex items-center justify-between"},Lt={class:"border-2 border-dashed border-gray-300 rounded-lg p-6 hover:border-gray-400 transition-colors"},Ot={class:"text-center"},Bt={class:"mt-4"},qt={key:0,class:"mt-4"},zt={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3"},It=["src","alt"],Gt=["onClick"],Ht={class:"text-xs text-gray-500 mt-2"},Kt={key:1,class:"text-sm text-red-600"},Jt={key:0,class:"p-4 bg-blue-50 border border-blue-200 rounded-md"},Wt={class:"flex items-start gap-3"},Xt={class:"text-sm text-blue-800 space-y-1"},Yt={key:0},Zt={key:1},Qt={key:2},es={class:"space-y-2"},ts={key:0,class:"text-sm text-red-600"},ss={class:"space-y-2"},os={key:0,class:"text-sm text-red-600"},ls={class:"flex justify-end gap-3"},Y=4*60,Es=ce({__name:"Create",props:{contractNumber:{},newCustomer:{}},setup(Z){const Q=Z,o=_e({customer_id:"",vehicle_id:"",start_date:"",end_date:"",daily_rate:0,deposit_amount:0,mileage_limit:"",excess_mileage_rate:"",terms_and_conditions:"",notes:"",current_mileage:"",fuel_level:"",condition_photos:null}),v=x(null),M=x(!1),U=x(null),h=x(1),q=pe(()=>{if(!o.start_date||!o.end_date)return 0;const a=new Date(o.start_date),e=new Date(o.end_date),n=Math.abs(e.getTime()-a.getTime());return Math.ceil(n/(1e3*60*60*24))}),E=x(0),$=x(0),A=x(""),F=x(""),_=x(null),B=x(!1),ee=a=>{const n=a.target.files;if(n){const y=Array.from(n).filter(w=>{const P=w.type.startsWith("image/"),N=w.size<=10*1024*1024;return P&&N}).slice(0,10);o.condition_photos=y}},te=a=>{o.condition_photos&&(o.condition_photos.splice(a,1),o.condition_photos.length===0&&(o.condition_photos=null))},se=a=>URL.createObjectURL(a),oe=a=>({full:"Full Tank (100%)","3/4":"3/4 Tank (75%)","1/2":"1/2 Tank (50%)","1/4":"1/4 Tank (25%)",low:"Low Fuel (< 25%)",empty:"Empty"})[a]||a,le=async()=>{var a;if(!o.vehicle_id||!o.start_date||!o.end_date){E.value=0,$.value=0,A.value="",F.value="",_.value=null,o.daily_rate=0;return}B.value=!0;try{const e=new URLSearchParams({vehicle_id:o.vehicle_id,start_date:o.start_date,end_date:o.end_date}),n=await fetch(`/api/pricing/calculate?${e}`,{method:"GET",headers:{Accept:"application/json","X-CSRF-Token":((a=document.querySelector('meta[name="csrf-token"]'))==null?void 0:a.getAttribute("content"))||""}});if(!n.ok)throw new Error("Failed to calculate pricing");const p=await n.json();E.value=p.total_amount,$.value=p.daily_rate,A.value=p.pricing_tier,F.value=p.rate_type,_.value=p.breakdown,o.daily_rate=p.daily_rate}catch(e){console.error("Error calculating pricing:",e),E.value=0,$.value=0,A.value="",F.value="",_.value=null,o.daily_rate=0}finally{B.value=!1}};R([()=>o.vehicle_id,()=>o.start_date,()=>o.end_date],async()=>{await le()});const ae=a=>{v.value=a,o.vehicle_id=a.id},re=a=>{we.post("/customers",a.data(),{onSuccess:e=>{var p,y;console.log("Customer creation success, page:",e),console.log("Page props:",e.props),console.log("Flash data:",e.props.flash);const n=e.props.newCustomer||((p=e.props.flash)==null?void 0:p.newCustomer)||((y=e.props.flash)==null?void 0:y.customer)||e.props.customer||null;console.log("Found customer data:",n),n?(o.customer_id=n.id,U.value?(console.log("Calling selectOption with:",n),U.value.selectOption(n)):console.log("Combobox ref not available")):console.log("No customer data found in response"),M.value=!1},onError:e=>{console.log("Validation errors:",e),Object.keys(e).forEach(n=>{n in a.errors&&a.setError(n,e[n])})},headers:{Accept:"application/json"}})},ne=()=>{M.value=!1},f=(a,e="AED")=>new Intl.NumberFormat("en-AE",{style:"currency",currency:e,minimumFractionDigits:2}).format(a),ie=()=>{const a=new Date;return new Date(a.getTime()+a.getTimezoneOffset()*6e4)},de=a=>new Date(a.getTime()+Y*6e4),z=a=>new Date(a.getTime()-Y*6e4),I=a=>{const e=a.getFullYear(),n=String(a.getMonth()+1).padStart(2,"0"),p=String(a.getDate()).padStart(2,"0"),y=String(a.getHours()).padStart(2,"0"),w=String(a.getMinutes()).padStart(2,"0");return`${e}-${n}-${p}T${y}:${w}`},G=()=>{const a=ie(),e=de(a);return I(e)},j=()=>{if(!o.start_date||!h.value||h.value<1)return;const a=new Date(o.start_date),e=new Date(a);e.setDate(a.getDate()+h.value),o.end_date=I(e)},ue=()=>{o.start_date||(o.start_date=G(),j())};R(h,()=>{o.start_date&&j()}),R(()=>o.start_date,()=>{o.start_date&&h.value>0&&j()});const me=()=>{const a={...o.data()};if(a.start_date){const e=new Date(a.start_date),n=z(e);a.start_date=n.toISOString()}if(a.end_date){const e=new Date(a.end_date),n=z(e);a.end_date=n.toISOString()}o.transform(e=>a).post(route("contracts.store"))};return fe(()=>{o.start_date||(o.start_date=G(),j())}),R(()=>Q.newCustomer,a=>{console.log("New customer prop received:",a),a&&(o.customer_id=a.id,U.value&&(console.log("Auto-selecting customer from props:",a),U.value.selectOption(a)))},{immediate:!0}),(a,e)=>(u(),m(L,null,[l(t(ve),{title:"Create Contract"}),l(ke,null,{default:r(()=>[s("div",Re,[s("div",Le,[s("div",Oe,[l(t(J),{href:a.route("contracts.index")},{default:r(()=>[l(t(O),{variant:"ghost",size:"sm"},{default:r(()=>[l(t(Me),{class:"w-4 h-4 mr-2"}),e[14]||(e[14]=d(" Back to Contracts "))]),_:1,__:[14]})]),_:1},8,["href"]),s("div",Be,[e[15]||(e[15]=s("h1",{class:"text-2xl font-semibold text-gray-900"},"Create New Contract",-1)),s("p",qe,"Contract Number: "+i(a.contractNumber),1)])]),s("form",{onSubmit:ge(me,["prevent"]),class:"space-y-6"},[s("div",ze,[l(t(C),null,{default:r(()=>[l(t(T),null,{default:r(()=>[l(t(S),{class:"flex items-center gap-2"},{default:r(()=>[l(t($e),{class:"w-5 h-5"}),e[16]||(e[16]=d(" Customer Information "))]),_:1,__:[16]}),l(t(V),null,{default:r(()=>e[17]||(e[17]=[d("Select or create a customer for this contract")])),_:1,__:[17]})]),_:1}),l(t(D),{class:"space-y-4"},{default:r(()=>[l(X,{ref_key:"customerComboboxRef",ref:U,modelValue:t(o).customer_id,"onUpdate:modelValue":e[0]||(e[0]=n=>t(o).customer_id=n),label:"Customer",placeholder:"Search customers...","search-url":"/api/customers/search",required:!0,error:t(o).errors.customer_id},null,8,["modelValue","error"]),s("div",Ie,[s("div",Ge,[e[21]||(e[21]=s("p",{class:"text-sm text-gray-500"}," Need to add a new customer? ",-1)),l(t(Ce),{open:M.value,"onUpdate:open":e[1]||(e[1]=n=>M.value=n)},{default:r(()=>[l(t(Ue),{"as-child":""},{default:r(()=>[l(t(O),{type:"button",variant:"outline",size:"sm"},{default:r(()=>[l(t(Ae),{class:"w-4 h-4 mr-2"}),e[18]||(e[18]=d(" Create Customer "))]),_:1,__:[18]})]),_:1}),l(t(De),{class:"max-w-2xl max-h-[90vh] overflow-y-auto"},{default:r(()=>[l(t(Se),null,{default:r(()=>[l(t(Ve),null,{default:r(()=>e[19]||(e[19]=[d("Create New Customer")])),_:1,__:[19]}),l(t(Te),null,{default:r(()=>e[20]||(e[20]=[d(" Add a new customer to your database. All fields marked with * are required. ")])),_:1,__:[20]})]),_:1}),l(Ee,{onSubmit:re,onCancel:ne})]),_:1})]),_:1},8,["open"])])])]),_:1})]),_:1}),l(t(C),null,{default:r(()=>[l(t(T),null,{default:r(()=>[l(t(S),{class:"flex items-center gap-2"},{default:r(()=>[l(t(Fe),{class:"w-5 h-5"}),e[22]||(e[22]=d(" Vehicle Information "))]),_:1,__:[22]}),l(t(V),null,{default:r(()=>e[23]||(e[23]=[d("Select the vehicle for this rental")])),_:1,__:[23]})]),_:1}),l(t(D),{class:"space-y-4"},{default:r(()=>[l(X,{modelValue:t(o).vehicle_id,"onUpdate:modelValue":e[2]||(e[2]=n=>t(o).vehicle_id=n),label:"Vehicle",placeholder:"Search vehicles...","search-url":"/api/vehicles/search",required:!0,error:t(o).errors.vehicle_id,onOptionSelected:ae},null,8,["modelValue","error"]),v.value?(u(),m("div",He,[e[27]||(e[27]=s("h4",{class:"font-medium text-gray-900 mb-2"},"Pricing Options",-1)),s("div",Ke,[s("div",null,[e[24]||(e[24]=s("span",{class:"text-gray-500"},"Daily:",-1)),s("p",Je,i(f(v.value.price_daily)),1)]),s("div",null,[e[25]||(e[25]=s("span",{class:"text-gray-500"},"Weekly:",-1)),s("p",We,i(f(v.value.price_weekly)),1)]),s("div",null,[e[26]||(e[26]=s("span",{class:"text-gray-500"},"Monthly:",-1)),s("p",Xe,i(f(v.value.price_monthly)),1)])])])):c("",!0)]),_:1})]),_:1})]),l(t(C),null,{default:r(()=>[l(t(T),null,{default:r(()=>[l(t(S),{class:"flex items-center gap-2"},{default:r(()=>[l(t(Pe),{class:"w-5 h-5"}),e[28]||(e[28]=d(" Contract Details "))]),_:1,__:[28]}),l(t(V),null,{default:r(()=>e[29]||(e[29]=[d("Set the rental period and terms")])),_:1,__:[29]})]),_:1}),l(t(D),{class:"space-y-6"},{default:r(()=>[s("div",Ye,[s("div",Ze,[l(t(g),{for:"start_date"},{default:r(()=>e[30]||(e[30]=[d("Start Date & Time * "),s("span",{class:"text-xs text-gray-500"},"(Dubai Time GMT+4)",-1)])),_:1,__:[30]}),l(t(b),{id:"start_date",type:"datetime-local",modelValue:t(o).start_date,"onUpdate:modelValue":e[3]||(e[3]=n=>t(o).start_date=n),required:""},null,8,["modelValue"]),t(o).errors.start_date?(u(),m("div",Qe,i(t(o).errors.start_date),1)):c("",!0),e[31]||(e[31]=s("p",{class:"text-xs text-gray-500"}," Times are displayed in Dubai timezone (GMT+4) ",-1))]),s("div",et,[l(t(g),{for:"end_date"},{default:r(()=>e[32]||(e[32]=[d("End Date & Time * "),s("span",{class:"text-xs text-gray-500"},"(Dubai Time GMT+4)",-1)])),_:1,__:[32]}),l(t(b),{id:"end_date",type:"datetime-local",modelValue:t(o).end_date,"onUpdate:modelValue":e[4]||(e[4]=n=>t(o).end_date=n),min:t(o).start_date,required:""},null,8,["modelValue","min"]),t(o).errors.end_date?(u(),m("div",tt,i(t(o).errors.end_date),1)):c("",!0),e[33]||(e[33]=s("p",{class:"text-xs text-gray-500"}," Automatically calculated based on duration ",-1))])]),s("div",st,[s("div",ot,[s("div",lt,[l(t(g),{for:"duration_days"},{default:r(()=>e[34]||(e[34]=[d("Duration (Days) *")])),_:1,__:[34]}),l(t(b),{id:"duration_days",type:"number",min:"1",max:"365",modelValue:h.value,"onUpdate:modelValue":e[5]||(e[5]=n=>h.value=n),modelModifiers:{number:!0},onFocus:ue,placeholder:"Enter number of days",required:""},null,8,["modelValue"]),e[35]||(e[35]=s("p",{class:"text-xs text-gray-500"}," Enter the number of rental days (minimum 1 day) ",-1))]),s("div",at,[s("div",rt,[s("p",nt,[e[36]||(e[36]=s("strong",null,"Rental Period:",-1)),d(" "+i(q.value)+" day"+i(q.value!==1?"s":"")+" ",1),t(o).start_date&&t(o).end_date?(u(),m("span",it,i(new Date(t(o).start_date).toLocaleDateString("en-AE",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}))+" → "+i(new Date(t(o).end_date).toLocaleDateString("en-AE",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})),1)):c("",!0)])])])])])]),_:1})]),_:1}),l(t(C),null,{default:r(()=>[l(t(T),null,{default:r(()=>[l(t(S),{class:"flex items-center gap-2"},{default:r(()=>[l(t(Ne),{class:"w-5 h-5"}),e[37]||(e[37]=d(" Pricing & Financial Details "))]),_:1,__:[37]}),l(t(V),null,{default:r(()=>e[38]||(e[38]=[d("Set rates and deposit requirements")])),_:1,__:[38]})]),_:1}),l(t(D),{class:"space-y-6"},{default:r(()=>{var n,p,y,w,P,N,H,K;return[s("div",dt,[s("div",ut,[l(t(g),{for:"daily_rate"},{default:r(()=>e[39]||(e[39]=[d("Daily Rate (AED) *")])),_:1,__:[39]}),l(t(b),{id:"daily_rate",type:"number",step:"0.01",min:"0",modelValue:t(o).daily_rate,"onUpdate:modelValue":e[6]||(e[6]=k=>t(o).daily_rate=k),required:""},null,8,["modelValue"]),t(o).errors.daily_rate?(u(),m("div",mt,i(t(o).errors.daily_rate),1)):c("",!0)]),s("div",ct,[l(t(g),{for:"deposit_amount"},{default:r(()=>e[40]||(e[40]=[d("Security Deposit (AED)")])),_:1,__:[40]}),l(t(b),{id:"deposit_amount",type:"number",step:"0.01",min:"0",modelValue:t(o).deposit_amount,"onUpdate:modelValue":e[7]||(e[7]=k=>t(o).deposit_amount=k)},null,8,["modelValue"]),t(o).errors.deposit_amount?(u(),m("div",_t,i(t(o).errors.deposit_amount),1)):c("",!0)])]),B.value?(u(),m("div",pt,e[41]||(e[41]=[s("div",{class:"flex items-center justify-center"},[s("span",{class:"text-blue-800"},"Calculating pricing...")],-1)]))):E.value>0?(u(),m("div",ft,[s("div",vt,[e[42]||(e[42]=s("span",{class:"text-green-800 font-medium"},"Total Rental Amount:",-1)),s("span",gt,i(f(E.value)),1)]),s("div",yt,[s("span",null,"Pricing Tier: "+i(A.value)+" ("+i(F.value)+")",1),s("span",null,"Effective Daily Rate: "+i(f($.value)),1)]),_.value?(u(),m("div",xt,[e[43]||(e[43]=s("h4",{class:"text-sm font-medium text-green-800 mb-2"},"Pricing Breakdown:",-1)),s("div",bt,[(n=_.value)!=null&&n.days?(u(),m("div",ht,[s("span",null,i(_.value.days)+" days @ "+i(f(t(o).daily_rate))+"/day",1),s("span",null,i(f(_.value.daily_cost||0)),1)])):c("",!0),((p=_.value)==null?void 0:p.complete_weeks)!==void 0?(u(),m(L,{key:1},[(_.value.complete_weeks||0)>0?(u(),m("div",wt,[s("span",null,i(_.value.complete_weeks)+" week(s) @ "+i(f(((y=v.value)==null?void 0:y.price_weekly)||0))+"/week",1),s("span",null,i(f(_.value.weekly_cost||0)),1)])):c("",!0),(_.value.remaining_days||0)>0?(u(),m("div",kt,[s("span",null,i(_.value.remaining_days)+" day(s) @ "+i(f(((w=v.value)==null?void 0:w.price_daily)||0))+"/day",1),s("span",null,i(f(_.value.daily_cost||0)),1)])):c("",!0)],64)):c("",!0),((P=_.value)==null?void 0:P.complete_months)!==void 0?(u(),m(L,{key:2},[(_.value.complete_months||0)>0?(u(),m("div",Ct,[s("span",null,i(_.value.complete_months)+" month(s) @ "+i(f(((N=v.value)==null?void 0:N.price_monthly)||0))+"/month",1),s("span",null,i(f(_.value.monthly_cost||0)),1)])):c("",!0),(_.value.complete_weeks||0)>0?(u(),m("div",Dt,[s("span",null,i(_.value.complete_weeks)+" week(s) @ "+i(f(((H=v.value)==null?void 0:H.price_weekly)||0))+"/week",1),s("span",null,i(f(_.value.weekly_cost||0)),1)])):c("",!0),(_.value.remaining_days||0)>0?(u(),m("div",Vt,[s("span",null,i(_.value.remaining_days)+" day(s) @ "+i(f(((K=v.value)==null?void 0:K.price_daily)||0))+"/day",1),s("span",null,i(f(_.value.daily_cost||0)),1)])):c("",!0)],64)):c("",!0)])])):c("",!0)])):c("",!0),s("div",Tt,[s("div",St,[l(t(g),{for:"mileage_limit"},{default:r(()=>e[44]||(e[44]=[d("Mileage Limit (KM)")])),_:1,__:[44]}),l(t(b),{id:"mileage_limit",type:"number",min:"0",modelValue:t(o).mileage_limit,"onUpdate:modelValue":e[8]||(e[8]=k=>t(o).mileage_limit=k),placeholder:"Unlimited if not specified"},null,8,["modelValue"]),t(o).errors.mileage_limit?(u(),m("div",Ut,i(t(o).errors.mileage_limit),1)):c("",!0)]),s("div",Et,[l(t(g),{for:"excess_mileage_rate"},{default:r(()=>e[45]||(e[45]=[d("Excess Mileage Rate (AED/KM)")])),_:1,__:[45]}),l(t(b),{id:"excess_mileage_rate",type:"number",step:"0.01",min:"0",modelValue:t(o).excess_mileage_rate,"onUpdate:modelValue":e[9]||(e[9]=k=>t(o).excess_mileage_rate=k)},null,8,["modelValue"]),t(o).errors.excess_mileage_rate?(u(),m("div",Mt,i(t(o).errors.excess_mileage_rate),1)):c("",!0)])])]}),_:1})]),_:1}),v.value?(u(),ye(t(C),{key:0},{default:r(()=>[l(t(T),null,{default:r(()=>[l(t(S),{class:"flex items-center gap-2"},{default:r(()=>e[46]||(e[46]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),d(" Vehicle Condition at Pickup ")])),_:1,__:[46]}),l(t(V),null,{default:r(()=>[d("Record the current condition of "+i(v.value.make)+" "+i(v.value.model),1)]),_:1})]),_:1}),l(t(D),{class:"space-y-6"},{default:r(()=>[s("div",$t,[s("div",At,[l(t(g),{for:"current_mileage"},{default:r(()=>e[47]||(e[47]=[d("Current Odometer Reading (KM) *")])),_:1,__:[47]}),l(t(b),{id:"current_mileage",type:"number",min:"0",step:"1",modelValue:t(o).current_mileage,"onUpdate:modelValue":e[10]||(e[10]=n=>t(o).current_mileage=n),placeholder:"Enter current mileage",required:""},null,8,["modelValue"]),t(o).errors.current_mileage?(u(),m("div",Ft,i(t(o).errors.current_mileage),1)):c("",!0),e[48]||(e[48]=s("p",{class:"text-xs text-gray-500"}," Record exact odometer reading at vehicle handover ",-1))]),s("div",jt,[l(t(g),{for:"fuel_level"},{default:r(()=>e[49]||(e[49]=[d("Current Fuel Level *")])),_:1,__:[49]}),xe(s("select",{id:"fuel_level","onUpdate:modelValue":e[11]||(e[11]=n=>t(o).fuel_level=n),required:"",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},e[50]||(e[50]=[s("option",{value:""},"Select fuel level",-1),s("option",{value:"full"},"Full Tank (100%)",-1),s("option",{value:"3/4"},"3/4 Tank (75%)",-1),s("option",{value:"1/2"},"1/2 Tank (50%)",-1),s("option",{value:"1/4"},"1/4 Tank (25%)",-1),s("option",{value:"low"},"Low Fuel (< 25%)",-1),s("option",{value:"empty"},"Empty",-1)]),512),[[be,t(o).fuel_level]]),t(o).errors.fuel_level?(u(),m("div",Pt,i(t(o).errors.fuel_level),1)):c("",!0),e[51]||(e[51]=s("p",{class:"text-xs text-gray-500"}," Customer will return vehicle at this level or pay refueling fee ",-1))])]),s("div",Nt,[s("div",Rt,[s("div",null,[l(t(g),{for:"condition_photos"},{default:r(()=>e[52]||(e[52]=[d("Vehicle Condition Photos")])),_:1,__:[52]}),e[53]||(e[53]=s("p",{class:"text-sm text-gray-500 mt-1"}," Upload photos to document current vehicle condition (optional) ",-1))]),e[54]||(e[54]=s("div",{class:"text-xs text-gray-400"}," Optional ",-1))]),s("div",Lt,[s("div",Ot,[e[56]||(e[56]=s("svg",{class:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48"},[s("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),s("div",Bt,[e[55]||(e[55]=s("label",{for:"condition_photos",class:"cursor-pointer"},[s("span",{class:"mt-2 block text-sm font-medium text-gray-900"}," Upload vehicle photos "),s("span",{class:"mt-1 block text-sm text-gray-500"}," PNG, JPG up to 10MB each ")],-1)),s("input",{id:"condition_photos",name:"condition_photos",type:"file",class:"sr-only",multiple:"",accept:"image/*",onChange:ee},null,32)])])]),t(o).condition_photos&&t(o).condition_photos.length>0?(u(),m("div",qt,[s("div",zt,[(u(!0),m(L,null,he(t(o).condition_photos,(n,p)=>(u(),m("div",{key:p,class:"relative group"},[s("img",{src:se(n),alt:`Vehicle condition ${p+1}`,class:"h-20 w-full object-cover rounded-md border border-gray-200"},null,8,It),s("button",{type:"button",onClick:y=>te(p),class:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs hover:bg-red-600 opacity-0 group-hover:opacity-100 transition-opacity"}," × ",8,Gt)]))),128))]),s("p",Ht,i(t(o).condition_photos.length)+" photo(s) selected ",1)])):c("",!0),t(o).errors.condition_photos?(u(),m("div",Kt,i(t(o).errors.condition_photos),1)):c("",!0)]),t(o).current_mileage||t(o).fuel_level||t(o).condition_photos&&t(o).condition_photos.length>0?(u(),m("div",Jt,[s("div",Wt,[e[61]||(e[61]=s("svg",{class:"w-5 h-5 text-blue-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),s("div",null,[e[60]||(e[60]=s("h4",{class:"font-medium text-blue-900 mb-1"},"Pickup Condition Summary",-1)),s("div",Xt,[t(o).current_mileage?(u(),m("p",Yt,[e[57]||(e[57]=s("strong",null,"Mileage:",-1)),d(" "+i(Number(t(o).current_mileage).toLocaleString())+" KM ",1)])):c("",!0),t(o).fuel_level?(u(),m("p",Zt,[e[58]||(e[58]=s("strong",null,"Fuel:",-1)),d(" "+i(oe(t(o).fuel_level)),1)])):c("",!0),t(o).condition_photos&&t(o).condition_photos.length>0?(u(),m("p",Qt,[e[59]||(e[59]=s("strong",null,"Photos:",-1)),d(" "+i(t(o).condition_photos.length)+" condition photo(s) attached ",1)])):c("",!0)])])])])):c("",!0)]),_:1})]),_:1})):c("",!0),l(t(C),null,{default:r(()=>[l(t(T),null,{default:r(()=>[l(t(S),{class:"flex items-center gap-2"},{default:r(()=>[l(t(je),{class:"w-5 h-5"}),e[62]||(e[62]=d(" Terms & Notes "))]),_:1,__:[62]}),l(t(V),null,{default:r(()=>e[63]||(e[63]=[d("Additional contract terms and internal notes")])),_:1,__:[63]})]),_:1}),l(t(D),{class:"space-y-4"},{default:r(()=>[s("div",es,[l(t(g),{for:"terms_and_conditions"},{default:r(()=>e[64]||(e[64]=[d("Terms and Conditions")])),_:1,__:[64]}),l(t(W),{id:"terms_and_conditions",modelValue:t(o).terms_and_conditions,"onUpdate:modelValue":e[12]||(e[12]=n=>t(o).terms_and_conditions=n),placeholder:"Enter specific terms and conditions for this contract...",rows:"4"},null,8,["modelValue"]),t(o).errors.terms_and_conditions?(u(),m("div",ts,i(t(o).errors.terms_and_conditions),1)):c("",!0)]),s("div",ss,[l(t(g),{for:"notes"},{default:r(()=>e[65]||(e[65]=[d("Internal Notes")])),_:1,__:[65]}),l(t(W),{id:"notes",modelValue:t(o).notes,"onUpdate:modelValue":e[13]||(e[13]=n=>t(o).notes=n),placeholder:"Add any internal notes about this contract...",rows:"3"},null,8,["modelValue"]),t(o).errors.notes?(u(),m("div",os,i(t(o).errors.notes),1)):c("",!0)])]),_:1})]),_:1}),s("div",ls,[l(t(J),{href:a.route("contracts.index")},{default:r(()=>[l(t(O),{type:"button",variant:"outline"},{default:r(()=>e[66]||(e[66]=[d("Cancel")])),_:1,__:[66]})]),_:1},8,["href"]),l(t(O),{type:"submit",disabled:t(o).processing},{default:r(()=>[d(i(t(o).processing?"Creating...":"Create Contract"),1)]),_:1},8,["disabled"])])],32)])])]),_:1})],64))}});export{Es as default};

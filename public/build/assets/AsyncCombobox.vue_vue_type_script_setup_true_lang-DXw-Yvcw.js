import{c as z,_ as S}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-qW6pmEna.js";import{_ as A}from"./Input.vue_vue_type_script_setup_true_lang-BYNpB8qG.js";import{_ as E}from"./Label.vue_vue_type_script_setup_true_lang-2Uh-HsNW.js";import{X as F}from"./AppSidebarLayout.vue_vue_type_script_setup_true_lang-D9xg78FF.js";import{C as U}from"./check-DyHuEZLi.js";import{d as j,r as c,w as B,a,o as t,m as f,j as u,f as h,u as r,e as b,h as q,t as y,b as p,n as D,F as L,l as R}from"./app-D0GmyGZl.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=z("ChevronDownIcon",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),G={class:"space-y-2"},H={key:0,class:"text-red-500"},J={class:"relative"},K={class:"relative"},M={class:"absolute inset-y-0 right-0 flex items-center pr-2 space-x-1"},P={key:0,class:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-md shadow-lg max-h-60 overflow-auto"},Q={key:0,class:"p-3 text-sm text-gray-500 text-center"},W={key:1,class:"p-3 text-sm text-gray-500 text-center"},Y={key:2,class:"p-3 text-sm text-gray-500 text-center"},Z={key:3},ee=["onClick"],te={key:1,class:"text-sm text-red-600"},de=j({__name:"AsyncCombobox",props:{modelValue:{},placeholder:{default:"Search..."},searchUrl:{},label:{},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},error:{}},emits:["update:modelValue","optionSelected"],setup(O,{expose:T,emit:$}){const _=O,i=$,l=c(""),n=c([]),m=c(!1),v=c(!1),s=c(null),g=c();let x;const k=async e=>{if(e.length<2){n.value=[];return}v.value=!0;try{const o=await(await fetch(`${_.searchUrl}?query=${encodeURIComponent(e)}`)).json();n.value=o}catch(d){console.error("Search error:",d),n.value=[]}finally{v.value=!1}},w=e=>{console.log("AsyncCombobox: Selecting option:",e),s.value=e,l.value=e.label,m.value=!1,i("update:modelValue",e.value),i("optionSelected",e),console.log("AsyncCombobox: Selection complete, emitted value:",e.value)},I=()=>{var e;s.value=null,l.value="",i("update:modelValue",""),n.value=[],(e=g.value)==null||e.focus()},C=()=>{m.value=!0,l.value.length>=2&&k(l.value)},N=()=>{setTimeout(()=>{m.value=!1},200)};return B(l,e=>{s.value&&e!==s.value.label&&(s.value=null,i("update:modelValue","")),clearTimeout(x),x=setTimeout(()=>{k(e)},300)}),B(()=>_.modelValue,e=>{e||(s.value=null,l.value="")},{immediate:!0}),T({selectOption:e=>{console.log("AsyncCombobox: External selection called with:",e),w(e)}}),(e,d)=>(t(),a("div",G,[e.label?(t(),f(r(E),{key:0,for:e.label},{default:b(()=>[q(y(e.label)+" ",1),e.required?(t(),a("span",H,"*")):u("",!0)]),_:1},8,["for"])):u("",!0),h("div",J,[h("div",K,[p(r(A),{ref_key:"inputRef",ref:g,modelValue:l.value,"onUpdate:modelValue":d[0]||(d[0]=o=>l.value=o),placeholder:e.placeholder,disabled:e.disabled,class:D(["pr-20",e.error?"border-red-500 focus:border-red-500 focus:ring-red-500":""]),onFocus:C,onBlur:N},null,8,["modelValue","placeholder","disabled","class"]),h("div",M,[s.value?(t(),f(r(S),{key:0,type:"button",variant:"ghost",size:"sm",class:"h-6 w-6 p-0 hover:bg-gray-100",onClick:I},{default:b(()=>[p(r(F),{class:"h-3 w-3"})]),_:1})):u("",!0),p(r(S),{type:"button",variant:"ghost",size:"sm",class:"h-6 w-6 p-0",disabled:e.disabled,onClick:C},{default:b(()=>[p(r(X),{class:"h-3 w-3"})]),_:1},8,["disabled"])])]),m.value?(t(),a("div",P,[v.value?(t(),a("div",Q," Searching... ")):n.value.length===0&&l.value.length>=2?(t(),a("div",W," No results found ")):l.value.length<2?(t(),a("div",Y," Type at least 2 characters to search ")):(t(),a("div",Z,[(t(!0),a(L,null,R(n.value,o=>{var V;return t(),a("button",{key:o.id,type:"button",class:"w-full px-3 py-2 text-left text-sm hover:bg-gray-100 focus:bg-gray-100 focus:outline-none flex items-center justify-between",onClick:ae=>w(o)},[h("span",null,y(o.label),1),((V=s.value)==null?void 0:V.id)===o.id?(t(),f(r(U),{key:0,class:"h-4 w-4 text-green-600"})):u("",!0)],8,ee)}),128))]))])):u("",!0)]),e.error?(t(),a("div",te,y(e.error),1)):u("",!0)]))}});export{de as _};
